2025-06-05 20:09:30,403 - __main__ - INFO - MongoDB connected to classy_skkkrapey
2025-06-05 20:09:30,403 - __main__ - INFO - Initialized IbizaSpotlightScraper with URL: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:30,403 - __main__ - INFO - Starting enhanced scraper run_id: 20250605_200930. CSV: scraped_events_20250605_200930.csv
2025-06-05 20:09:30,403 - __main__ - INFO - Starting with URL: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:30,407 - __main__ - INFO - Processing [0]: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:30,407 - __main__ - INFO - Main events page detected - extracting venue/club/promoter URLs only
2025-06-05 20:09:30,433 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:33,394 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:09:38,404 - __main__ - INFO - Scroll attempt 1: height 9675
2025-06-05 20:09:40,409 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:09:40,410 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:09:40,701 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:09:40,701 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,702 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,716 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:09:40,716 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/venue/bam-bu-ku-ibiza
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,717 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/do-not-sleep-amnesia
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pacha-pre-season-parties
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/camelphat-pacha
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/abracadabra-pacha
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/defected
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/music-on
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pure-pacha
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pacha-pre-season-parties
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/tomorrowland-presents-dimitri-vegas-mike
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/calvin-harris-friday
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ants
2025-06-05 20:09:40,745 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/nothing-trouble-eden
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/drama-club
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/deeperfect-eden
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/one-more-time-eden
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/reboot-presents-eden
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/bukkle-ibiza
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/abode-eden
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/daydreamers
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/reboot-rocks
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/craig-davids-ts5
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-anthems-ibiza-rocks
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-rocks-pool-days
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/lovejuice-ibiza-rocks
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/r-and-b-affair
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/d4-d4nce-o-beach
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/kisstory-o-beach
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/house-paradise
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/one
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pool-party-o-beach
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/soul-heaven
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/sin-sundays
2025-06-05 20:09:40,746 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/kaluki-528
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/saturdays
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/heavy-house-society-528
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/you-know-vibes
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/tuesdays-es-paradis
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/bubbles-champagne
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/thursdays-es-paradis
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/puro-reggaeton
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/fiesta-del-agua
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/sundays-es-paradis
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/blanche-london
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/playground-toy-room
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/tiempo-nomis
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/vintage-lio
2025-06-05 20:09:40,747 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pandora
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/travieso
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/el-kiddo-bam-bu-ku
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-brunch-club-classics
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/latin-pool-bbk
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/el-kiddo-bam-bu-ku
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/el-paripe
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/fridays-at-tipic
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/saturdays-tipic
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/el-paripe
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:09:40,748 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:09:40,749 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:09:40,749 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:09:40,749 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:09:40,749 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:09:40,749 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:09:40,750 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:09:40,751 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:09:40,841 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.es/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.de/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.it/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.es/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.de/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.it/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06/05
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=02/06/2025-08/06/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=09/06/2025-15/06/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=05/06/2025-11/06/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/07
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/07
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/08
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/09
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/10
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=02/06/2025-08/06/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=09/06/2025-15/06/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=16/06/2025-22/06/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=23/06/2025-29/06/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=30/06/2025-06/07/2025
2025-06-05 20:09:40,842 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/05?daterange=19/05/2025-25/05/2025
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=02/06/2025-08/06/2025
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/05/26
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/05/27
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/05/28
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/05/29
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/05/30
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/05/31
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06/01
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=02/06/2025-08/06/2025
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=09/06/2025-15/06/2025
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=16/06/2025-22/06/2025
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=23/06/2025-29/06/2025
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=30/06/2025-06/07/2025
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2008/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2009/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2010/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2011/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2012/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2013/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2014/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2015/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2016/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2017/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2018/06
2025-06-05 20:09:40,843 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2019/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2020/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2021/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2022/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2023/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Found potential venue/club/promoter URL: https://www.ibiza-spotlight.com/night/events/2024/06
2025-06-05 20:09:40,844 - __main__ - INFO - Extracted 132 potential venue/club/promoter URLs from https://www.ibiza-spotlight.com/night/events/2025/06
2025-06-05 20:09:40,844 - __main__ - INFO - DEBUG: Found 132 potential URLs from main events page
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/lovejuice-ibiza-rocks
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/05/28
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/playground-toy-room
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.it/night/events/2025/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/tuesdays-es-paradis
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/d4-d4nce-o-beach
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/pure-pacha
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/09
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2023/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/house-paradise
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2017/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/el-kiddo-bam-bu-ku
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/travieso
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/r-and-b-affair
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=23/06/2025-29/06/2025
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/05/31
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/latin-pool-bbk
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/ants
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/deeperfect-eden
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/pool-party-o-beach
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/05/29
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/bubbles-champagne
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2009/06
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/tomorrowland-presents-dimitri-vegas-mike
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/kaluki-528
2025-06-05 20:09:40,844 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/craig-davids-ts5
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/puro-reggaeton
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/blanche-london
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/pacha-pre-season-parties
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/el-paripe
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2020/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/abode-eden
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/drama-club
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/tiempo-nomis
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/thursdays-es-paradis
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=05/06/2025-11/06/2025
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/pandora
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=02/06/2025-08/06/2025
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/reboot-rocks
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2021/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/nothing-trouble-eden
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/05/26
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/sundays-es-paradis
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2022/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/defected
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.de/night/events/2025/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/heavy-house-society-528
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=16/06/2025-22/06/2025
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/sin-sundays
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2011/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/daydreamers
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/soul-heaven
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/fiesta-del-agua
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/10
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2018/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=30/06/2025-06/07/2025
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/08
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/05?daterange=19/05/2025-25/05/2025
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2010/06
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/calvin-harris-friday
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/music-on
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:09:40,845 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2014/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2024/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2015/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/one
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2012/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/saturdays
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/ibiza-anthems-ibiza-rocks
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/venue/bam-bu-ku-ibiza
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/05/30
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2013/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/you-know-vibes
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2019/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06/01
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/07
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/kisstory-o-beach
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2008/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/reboot-presents-eden
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/05/27
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2016/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/do-not-sleep-amnesia
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06/05
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/camelphat-pacha
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/abracadabra-pacha
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/ibiza-rocks-pool-days
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/fridays-at-tipic
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=09/06/2025-15/06/2025
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.es/night/events/2025/06
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/bukkle-ibiza
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/one-more-time-eden
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/vintage-lio
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/saturdays-tipic
2025-06-05 20:09:40,846 - __main__ - DEBUG - Added URL to queue: https://www.ibiza-spotlight.com/night/promoters/ibiza-brunch-club-classics
2025-06-05 20:09:45,104 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/lovejuice-ibiza-rocks
2025-06-05 20:09:45,105 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/lovejuice-ibiza-rocks
2025-06-05 20:09:45,105 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/lovejuice-ibiza-rocks
2025-06-05 20:09:47,604 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:09:52,618 - __main__ - INFO - Scroll attempt 1: height 6261
2025-06-05 20:09:54,627 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:09:54,627 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:09:54,832 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/lovejuice-ibiza-rocks
2025-06-05 20:09:55,081 - __main__ - INFO - Added JSON-LD event: LoveJuice Ibiza Opening Party
2025-06-05 20:09:55,081 - __main__ - INFO - Added JSON-LD event: LoveJuice Ibiza Pool Party
2025-06-05 20:09:55,081 - __main__ - INFO - Added JSON-LD event: LoveJuice Ibiza Closing Party
2025-06-05 20:09:55,405 - __main__ - INFO - Found 3 events on promoter page lovejuice-ibiza-rocks
2025-06-05 20:09:55,405 - __main__ - ERROR - Error saving event 'LoveJuice Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:09:55,407 - __main__ - ERROR - Error saving event 'LoveJuice Ibiza Pool Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:09:55,407 - __main__ - ERROR - Error saving event 'LoveJuice Ibiza Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:09:55,408 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:09:59,458 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/05/28
2025-06-05 20:09:59,458 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/05/28
2025-06-05 20:10:02,439 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/playground-toy-room
2025-06-05 20:10:02,440 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/playground-toy-room
2025-06-05 20:10:02,440 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/playground-toy-room
2025-06-05 20:10:04,979 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:10:09,989 - __main__ - INFO - Scroll attempt 1: height 4582
2025-06-05 20:10:11,995 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:10:11,995 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:10:12,117 - __main__ - WARNING - No year context found for https://www.ibiza-spotlight.com/night/promoters/playground-toy-room
2025-06-05 20:10:12,293 - __main__ - INFO - Added JSON-LD event: Toy Room Opening Party
2025-06-05 20:10:12,293 - __main__ - INFO - Added JSON-LD event: Toy Room
2025-06-05 20:10:12,293 - __main__ - INFO - Added JSON-LD event: Toy Room Closing Party
2025-06-05 20:10:12,500 - __main__ - INFO - Found 3 events on promoter page playground-toy-room
2025-06-05 20:10:12,500 - __main__ - ERROR - Error saving event 'Toy Room Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:10:12,501 - __main__ - ERROR - Error saving event 'Toy Room': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:10:12,501 - __main__ - ERROR - Error saving event 'Toy Room Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:10:12,501 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:10:15,194 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:10:15,194 - __main__ - INFO - Updated venue context from 'None' to 'cova-santa' for URL https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:10:15,194 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:10:15,195 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:10:18,120 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:10:23,131 - __main__ - INFO - Scroll attempt 1: height 5813
2025-06-05 20:10:25,136 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:10:25,136 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/afrodise-moots
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/afrodise-moots
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/fuego-silvia-superstar
2025-06-05 20:10:25,261 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/fuego-silvia-superstar
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/cosmic-pineapple
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/cosmic-pineapple
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/cova-santa-opening-party
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/cova-santa-opening-party
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/cova-santa-presents
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/cova-santa-presents
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/eastenderz-cova-santa
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/eastenderz-cova-santa
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:10:25,262 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:10:25,265 - __main__ - INFO - Extracted 14 promoter URLs from https://www.ibiza-spotlight.com/night/venue/cova-santa
2025-06-05 20:10:25,266 - __main__ - INFO - DEBUG: Found 14 promoter URLs from venue/club page 'cova-santa'
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/cova-santa-presents
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/fuego-silvia-superstar
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/cova-santa-opening-party
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/eastenderz-cova-santa
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/afrodise-moots
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:10:25,266 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/cosmic-pineapple
2025-06-05 20:10:30,909 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:10:30,909 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:10:30,910 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:10:33,439 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:10:38,449 - __main__ - INFO - Scroll attempt 1: height 9365
2025-06-05 20:10:40,454 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:10:40,454 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:10:40,764 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:10:41,249 - __main__ - INFO - Added JSON-LD event: Aftersun Ibiza Boat Party
2025-06-05 20:10:41,249 - __main__ - INFO - Added JSON-LD event: Aftersun Ibiza Boat Party | Easter Sailing
2025-06-05 20:10:41,649 - __main__ - INFO - Found 2 events on promoter page aftersun-ibiza-ibiza-boat-club
2025-06-05 20:10:41,649 - __main__ - ERROR - Error saving event 'Aftersun Ibiza Boat Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:10:41,649 - __main__ - ERROR - Error saving event 'Aftersun Ibiza Boat Party | Easter Sailing': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:10:41,650 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:10:46,654 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.it/night/events/2025/06
2025-06-05 20:10:46,654 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.it/night/events/2025/06
2025-06-05 20:10:51,484 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:10:51,484 - __main__ - INFO - Updated venue context from 'cova-santa' to 'boat-parties-san-antonio' for URL https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:10:51,484 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:10:51,484 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:10:54,086 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:10:59,097 - __main__ - INFO - Scroll attempt 1: height 5016
2025-06-05 20:11:01,102 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:11:01,103 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:11:01,210 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:11:01,210 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:11:01,211 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:11:01,211 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:11:01,211 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:11:01,211 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:11:01,211 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:11:01,211 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:11:01,214 - __main__ - INFO - Extracted 4 promoter URLs from https://www.ibiza-spotlight.com/night/venue/boat-parties-san-antonio
2025-06-05 20:11:01,214 - __main__ - INFO - DEBUG: Found 4 promoter URLs from venue/club page 'boat-parties-san-antonio'
2025-06-05 20:11:01,214 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:11:01,214 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:11:01,214 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:11:01,214 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:11:04,683 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:11:04,683 - __main__ - INFO - Updated venue context from 'boat-parties-san-antonio' to 'unvrs' for URL https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:11:04,683 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:11:04,683 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:11:07,201 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:11:12,212 - __main__ - INFO - Scroll attempt 1: height 6204
2025-06-05 20:11:14,217 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:11:14,217 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/eric-prydz-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/eric-prydz-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/fisher-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/fisher-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/elrow-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/elrow-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/david-guetta-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/david-guetta-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/anotr-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/anotr-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/paradise-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/paradise-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/carl-cox
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/carl-cox
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/anyma-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/anyma-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/sara-landry-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/sara-landry-unvrs
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:11:14,343 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:11:14,344 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:11:14,347 - __main__ - INFO - Extracted 10 promoter URLs from https://www.ibiza-spotlight.com/night/venue/unvrs
2025-06-05 20:11:14,347 - __main__ - INFO - DEBUG: Found 10 promoter URLs from venue/club page 'unvrs'
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/anotr-unvrs
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/paradise-unvrs
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/eric-prydz-unvrs
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/anyma-unvrs
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/carl-cox
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/david-guetta-unvrs
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/sara-landry-unvrs
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/fisher-unvrs
2025-06-05 20:11:14,347 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/elrow-unvrs
2025-06-05 20:11:18,505 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:11:18,505 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:11:18,505 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:11:21,049 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:11:26,059 - __main__ - INFO - Scroll attempt 1: height 4978
2025-06-05 20:11:28,065 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:11:28,065 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:11:28,192 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:11:28,355 - __main__ - INFO - Added JSON-LD event: All I Need Opening Party
2025-06-05 20:11:28,355 - __main__ - INFO - Added JSON-LD event: All I Need
2025-06-05 20:11:28,355 - __main__ - INFO - Added JSON-LD event: All I Need Closing Party
2025-06-05 20:11:28,526 - __main__ - INFO - Found 3 events on promoter page all-i-need-playa-soleil
2025-06-05 20:11:28,526 - __main__ - ERROR - Error saving event 'All I Need Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:11:28,527 - __main__ - ERROR - Error saving event 'All I Need': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:11:28,527 - __main__ - ERROR - Error saving event 'All I Need Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:11:28,528 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:11:34,255 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/tuesdays-es-paradis
2025-06-05 20:11:34,255 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/tuesdays-es-paradis
2025-06-05 20:11:34,255 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/tuesdays-es-paradis
2025-06-05 20:11:36,840 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:11:41,851 - __main__ - INFO - Scroll attempt 1: height 4709
2025-06-05 20:11:43,857 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:11:43,857 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:11:43,979 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/tuesdays-es-paradis
2025-06-05 20:11:44,141 - __main__ - INFO - Added JSON-LD event: Ibiza Records Opening Party
2025-06-05 20:11:44,141 - __main__ - INFO - Added JSON-LD event: Ibiza Records
2025-06-05 20:11:44,141 - __main__ - INFO - Added JSON-LD event: Ibiza Records Closing Party
2025-06-05 20:11:44,306 - __main__ - INFO - Found 3 events on promoter page tuesdays-es-paradis
2025-06-05 20:11:44,307 - __main__ - ERROR - Error saving event 'Ibiza Records Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:11:44,307 - __main__ - ERROR - Error saving event 'Ibiza Records': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:11:44,308 - __main__ - ERROR - Error saving event 'Ibiza Records Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:11:44,308 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:11:48,821 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:11:48,822 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:11:48,822 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:11:51,578 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:11:56,589 - __main__ - INFO - Scroll attempt 1: height 6063
2025-06-05 20:11:58,595 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:11:58,596 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:11:58,762 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:11:59,041 - __main__ - INFO - Added JSON-LD event: Panthen Opening Party
2025-06-05 20:11:59,041 - __main__ - INFO - Added JSON-LD event: Panthen
2025-06-05 20:11:59,041 - __main__ - INFO - Added JSON-LD event: Panthen | AMM presents One Tribe
2025-06-05 20:11:59,041 - __main__ - INFO - Added JSON-LD event: Panthen Closing Party
2025-06-05 20:12:00,179 - __main__ - INFO - Found 4 events on promoter page pantheon
2025-06-05 20:12:00,179 - __main__ - ERROR - Error saving event 'Panthen Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:00,180 - __main__ - ERROR - Error saving event 'Panthen': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:00,180 - __main__ - ERROR - Error saving event 'Panthen | AMM presents One Tribe': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:00,181 - __main__ - ERROR - Error saving event 'Panthen Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:00,181 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:12:04,825 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/d4-d4nce-o-beach
2025-06-05 20:12:04,826 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/d4-d4nce-o-beach
2025-06-05 20:12:04,826 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/d4-d4nce-o-beach
2025-06-05 20:12:07,616 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:12:12,627 - __main__ - INFO - Scroll attempt 1: height 6528
2025-06-05 20:12:14,633 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:12:14,633 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:12:14,793 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/d4-d4nce-o-beach
2025-06-05 20:12:15,028 - __main__ - INFO - Added JSON-LD event: D4 D4NCE Opening Party
2025-06-05 20:12:15,028 - __main__ - INFO - Added JSON-LD event: D4 D4NCE
2025-06-05 20:12:15,028 - __main__ - INFO - Added JSON-LD event: D4 D4NCE Closing Party
2025-06-05 20:12:15,289 - __main__ - INFO - Found 3 events on promoter page d4-d4nce-o-beach
2025-06-05 20:12:15,289 - __main__ - ERROR - Error saving event 'D4 D4NCE Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:15,292 - __main__ - ERROR - Error saving event 'D4 D4NCE': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:15,293 - __main__ - ERROR - Error saving event 'D4 D4NCE Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:15,293 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:12:18,002 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/pure-pacha
2025-06-05 20:12:18,003 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/pure-pacha
2025-06-05 20:12:18,003 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/pure-pacha
2025-06-05 20:12:20,850 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:12:25,860 - __main__ - INFO - Scroll attempt 1: height 5718
2025-06-05 20:12:27,866 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:12:27,866 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:12:27,985 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/pure-pacha
2025-06-05 20:12:28,104 - __main__ - INFO - Added JSON-LD event: Pure Pacha presents Robin Schulz Opening Party
2025-06-05 20:12:28,104 - __main__ - INFO - Added JSON-LD event: Pure Pacha presents Robin Schulz
2025-06-05 20:12:28,104 - __main__ - INFO - Added JSON-LD event: Pure Pacha presents Robin Schulz Closing Party
2025-06-05 20:12:28,894 - __main__ - INFO - Found 3 events on promoter page pure-pacha
2025-06-05 20:12:28,894 - __main__ - ERROR - Error saving event 'Pure Pacha presents Robin Schulz Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:28,894 - __main__ - ERROR - Error saving event 'Pure Pacha presents Robin Schulz': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:28,895 - __main__ - ERROR - Error saving event 'Pure Pacha presents Robin Schulz Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:28,895 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:12:32,893 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:12:32,894 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:12:32,894 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:12:35,683 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:12:40,706 - __main__ - INFO - Scroll attempt 1: height 7144
2025-06-05 20:12:42,710 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:12:42,710 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:12:42,881 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:12:43,106 - __main__ - INFO - Added JSON-LD event: Woomoon Opening Party
2025-06-05 20:12:43,106 - __main__ - INFO - Added JSON-LD event: Woomoon
2025-06-05 20:12:43,106 - __main__ - INFO - Added JSON-LD event: Woomoon Closing Party
2025-06-05 20:12:43,939 - __main__ - INFO - Found 3 events on promoter page woomoon
2025-06-05 20:12:43,939 - __main__ - ERROR - Error saving event 'Woomoon Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:43,940 - __main__ - ERROR - Error saving event 'Woomoon': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:43,940 - __main__ - ERROR - Error saving event 'Woomoon Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:12:43,941 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:12:49,397 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/09
2025-06-05 20:12:49,397 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/09
2025-06-05 20:12:52,499 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:12:52,500 - __main__ - INFO - Updated venue context from 'unvrs' to 'hard-rock-hotel' for URL https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:12:52,500 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:12:52,500 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:12:54,986 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:12:59,998 - __main__ - INFO - Scroll attempt 1: height 5431
2025-06-05 20:13:02,004 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:13:02,004 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:13:02,122 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:13:02,122 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:13:02,122 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:13:02,122 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:13:02,122 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:13:02,125 - __main__ - INFO - Extracted 1 promoter URLs from https://www.ibiza-spotlight.com/night/venue/hard-rock-hotel
2025-06-05 20:13:02,125 - __main__ - INFO - DEBUG: Found 1 promoter URLs from venue/club page 'hard-rock-hotel'
2025-06-05 20:13:02,126 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:13:07,168 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2023/06
2025-06-05 20:13:07,168 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2023/06
2025-06-05 20:13:09,805 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:13:09,806 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:13:09,806 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:13:12,379 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:13:17,391 - __main__ - INFO - Scroll attempt 1: height 6807
2025-06-05 20:13:19,396 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:13:19,396 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:13:19,566 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:13:19,793 - __main__ - INFO - Added JSON-LD event: Black Coffee Opening Party
2025-06-05 20:13:19,793 - __main__ - INFO - Added JSON-LD event: Black Coffee
2025-06-05 20:13:19,793 - __main__ - INFO - Added JSON-LD event: Black Coffee Closing Party
2025-06-05 20:13:21,045 - __main__ - INFO - Found 3 events on promoter page black-coffee
2025-06-05 20:13:21,046 - __main__ - ERROR - Error saving event 'Black Coffee Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:13:21,046 - __main__ - ERROR - Error saving event 'Black Coffee': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:13:21,047 - __main__ - ERROR - Error saving event 'Black Coffee Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:13:21,047 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:13:26,237 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/house-paradise
2025-06-05 20:13:26,237 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/house-paradise
2025-06-05 20:13:26,238 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/house-paradise
2025-06-05 20:13:29,022 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:13:34,032 - __main__ - INFO - Scroll attempt 1: height 6527
2025-06-05 20:13:36,038 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:13:36,038 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:13:36,208 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/house-paradise
2025-06-05 20:13:36,442 - __main__ - INFO - Added JSON-LD event: House In Paradise Opening Party
2025-06-05 20:13:36,442 - __main__ - INFO - Added JSON-LD event: House In Paradise
2025-06-05 20:13:36,442 - __main__ - INFO - Added JSON-LD event: House In Paradise Closing Party
2025-06-05 20:13:37,793 - __main__ - INFO - Found 3 events on promoter page house-paradise
2025-06-05 20:13:37,793 - __main__ - ERROR - Error saving event 'House In Paradise Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:13:37,794 - __main__ - ERROR - Error saving event 'House In Paradise': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:13:37,794 - __main__ - ERROR - Error saving event 'House In Paradise Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:13:37,794 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:13:41,718 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2017/06
2025-06-05 20:13:41,719 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2017/06
2025-06-05 20:13:46,969 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/el-kiddo-bam-bu-ku
2025-06-05 20:13:46,969 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/el-kiddo-bam-bu-ku
2025-06-05 20:13:46,969 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/el-kiddo-bam-bu-ku
2025-06-05 20:13:49,391 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:13:54,403 - __main__ - INFO - Scroll attempt 1: height 6352
2025-06-05 20:13:56,408 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:13:56,408 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:13:56,569 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/el-kiddo-bam-bu-ku
2025-06-05 20:13:56,819 - __main__ - INFO - Added JSON-LD event: El Kiddo
2025-06-05 20:13:56,964 - __main__ - INFO - Found 1 events on promoter page el-kiddo-bam-bu-ku
2025-06-05 20:13:56,964 - __main__ - ERROR - Error saving event 'El Kiddo': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:13:56,964 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:14:00,327 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:14:00,327 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:14:00,327 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:14:03,118 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:14:08,141 - __main__ - INFO - Scroll attempt 1: height 8271
2025-06-05 20:14:10,146 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:14:10,146 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:14:10,339 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:14:10,663 - __main__ - INFO - Added JSON-LD event: A Day In Paradise Boat Trip
2025-06-05 20:14:11,491 - __main__ - INFO - Found 1 events on promoter page day-paradise
2025-06-05 20:14:11,491 - __main__ - ERROR - Error saving event 'A Day In Paradise Boat Trip': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:11,492 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:14:15,034 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/travieso
2025-06-05 20:14:15,034 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/travieso
2025-06-05 20:14:15,034 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/travieso
2025-06-05 20:14:17,581 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:14:22,591 - __main__ - INFO - Scroll attempt 1: height 4505
2025-06-05 20:14:24,597 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:14:24,597 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:14:24,718 - __main__ - WARNING - No year context found for https://www.ibiza-spotlight.com/night/promoters/travieso
2025-06-05 20:14:24,855 - __main__ - INFO - Added JSON-LD event: Travieso Opening Party
2025-06-05 20:14:24,855 - __main__ - INFO - Added JSON-LD event: Travieso
2025-06-05 20:14:24,855 - __main__ - INFO - Added JSON-LD event: Travieso Closing Party
2025-06-05 20:14:25,043 - __main__ - INFO - Found 3 events on promoter page travieso
2025-06-05 20:14:25,044 - __main__ - ERROR - Error saving event 'Travieso Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:25,044 - __main__ - ERROR - Error saving event 'Travieso': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:25,045 - __main__ - ERROR - Error saving event 'Travieso Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:25,045 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:14:28,537 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:14:28,538 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:14:28,538 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:14:31,024 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:14:36,035 - __main__ - INFO - Scroll attempt 1: height 11262
2025-06-05 20:14:38,040 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:14:38,040 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:14:38,423 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:14:39,069 - __main__ - INFO - Added JSON-LD event: Formentera With Benefits | Easter Sailing
2025-06-05 20:14:39,069 - __main__ - INFO - Added JSON-LD event: Formentera With Benefits
2025-06-05 20:14:40,792 - __main__ - INFO - Found 2 events on promoter page ibiza-boat-club-formentera
2025-06-05 20:14:40,792 - __main__ - ERROR - Error saving event 'Formentera With Benefits | Easter Sailing': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:40,793 - __main__ - ERROR - Error saving event 'Formentera With Benefits': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:40,793 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:14:43,963 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/r-and-b-affair
2025-06-05 20:14:43,963 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/r-and-b-affair
2025-06-05 20:14:43,963 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/r-and-b-affair
2025-06-05 20:14:46,463 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:14:51,474 - __main__ - INFO - Scroll attempt 1: height 5329
2025-06-05 20:14:53,479 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:14:53,480 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:14:53,624 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/r-and-b-affair
2025-06-05 20:14:53,856 - __main__ - INFO - Added JSON-LD event: R&amp;B Affair Opening Party
2025-06-05 20:14:53,856 - __main__ - INFO - Added JSON-LD event: R&amp;B Affair Pool Party
2025-06-05 20:14:53,856 - __main__ - INFO - Added JSON-LD event: R&amp;B Affair Closing Party
2025-06-05 20:14:54,090 - __main__ - INFO - Found 3 events on promoter page r-and-b-affair
2025-06-05 20:14:54,090 - __main__ - ERROR - Error saving event 'R&amp;B Affair Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:54,090 - __main__ - ERROR - Error saving event 'R&amp;B Affair Pool Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:54,091 - __main__ - ERROR - Error saving event 'R&amp;B Affair Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:14:54,091 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:14:59,449 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=23/06/2025-29/06/2025
2025-06-05 20:14:59,450 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=23/06/2025-29/06/2025
2025-06-05 20:15:05,048 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/05/31
2025-06-05 20:15:05,048 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/05/31
2025-06-05 20:15:07,608 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/latin-pool-bbk
2025-06-05 20:15:07,608 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/latin-pool-bbk
2025-06-05 20:15:07,608 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/latin-pool-bbk
2025-06-05 20:15:10,848 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:15:15,859 - __main__ - INFO - Scroll attempt 1: height 4966
2025-06-05 20:15:17,864 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:15:17,864 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:15:17,954 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/latin-pool-bbk
2025-06-05 20:15:18,065 - __main__ - INFO - Added JSON-LD event: Latin Pool Opening Party
2025-06-05 20:15:18,066 - __main__ - INFO - Added JSON-LD event: Latin Pool
2025-06-05 20:15:18,066 - __main__ - INFO - Added JSON-LD event: Latin Pool Closing Party
2025-06-05 20:15:18,531 - __main__ - INFO - Found 3 events on promoter page latin-pool-bbk
2025-06-05 20:15:18,531 - __main__ - ERROR - Error saving event 'Latin Pool Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:18,532 - __main__ - ERROR - Error saving event 'Latin Pool': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:18,532 - __main__ - ERROR - Error saving event 'Latin Pool Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:18,532 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:15:23,987 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/ants
2025-06-05 20:15:23,988 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/ants
2025-06-05 20:15:23,988 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/ants
2025-06-05 20:15:26,496 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:15:31,506 - __main__ - INFO - Scroll attempt 1: height 6997
2025-06-05 20:15:33,511 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:15:33,511 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:15:33,717 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/ants
2025-06-05 20:15:34,029 - __main__ - INFO - Added JSON-LD event: ANTS Opening Party
2025-06-05 20:15:34,030 - __main__ - INFO - Added JSON-LD event: ANTS
2025-06-05 20:15:34,030 - __main__ - INFO - Added JSON-LD event: ANTS Closing Party
2025-06-05 20:15:35,696 - __main__ - INFO - Found 3 events on promoter page ants
2025-06-05 20:15:35,696 - __main__ - ERROR - Error saving event 'ANTS Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:35,696 - __main__ - ERROR - Error saving event 'ANTS': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:35,697 - __main__ - ERROR - Error saving event 'ANTS Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:35,697 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:15:40,713 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/deeperfect-eden
2025-06-05 20:15:40,713 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/deeperfect-eden
2025-06-05 20:15:40,713 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/deeperfect-eden
2025-06-05 20:15:43,793 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:15:48,804 - __main__ - INFO - Scroll attempt 1: height 5102
2025-06-05 20:15:50,809 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:15:50,809 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:15:50,924 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/deeperfect-eden
2025-06-05 20:15:51,026 - __main__ - INFO - Added JSON-LD event: Deeperfect Opening Party
2025-06-05 20:15:51,027 - __main__ - INFO - Added JSON-LD event: Deeperfect
2025-06-05 20:15:51,027 - __main__ - INFO - Added JSON-LD event: Deeperfect Closing Party
2025-06-05 20:15:51,189 - __main__ - INFO - Found 3 events on promoter page deeperfect-eden
2025-06-05 20:15:51,189 - __main__ - ERROR - Error saving event 'Deeperfect Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:51,189 - __main__ - ERROR - Error saving event 'Deeperfect': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:51,190 - __main__ - ERROR - Error saving event 'Deeperfect Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:15:51,190 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:15:56,007 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/pool-party-o-beach
2025-06-05 20:15:56,008 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/pool-party-o-beach
2025-06-05 20:15:56,008 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/pool-party-o-beach
2025-06-05 20:15:59,046 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:16:04,057 - __main__ - INFO - Scroll attempt 1: height 6405
2025-06-05 20:16:06,062 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:16:06,062 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:16:06,232 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/pool-party-o-beach
2025-06-05 20:16:06,482 - __main__ - INFO - Added JSON-LD event: Pool Party Opening
2025-06-05 20:16:06,483 - __main__ - INFO - Added JSON-LD event: Pool Party
2025-06-05 20:16:06,483 - __main__ - INFO - Added JSON-LD event: Pool Party Closing
2025-06-05 20:16:06,746 - __main__ - INFO - Found 3 events on promoter page pool-party-o-beach
2025-06-05 20:16:06,746 - __main__ - ERROR - Error saving event 'Pool Party Opening': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:06,747 - __main__ - ERROR - Error saving event 'Pool Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:06,747 - __main__ - ERROR - Error saving event 'Pool Party Closing': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:06,748 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:16:10,519 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/05/29
2025-06-05 20:16:10,519 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/05/29
2025-06-05 20:16:15,116 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/bubbles-champagne
2025-06-05 20:16:15,117 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/bubbles-champagne
2025-06-05 20:16:15,117 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/bubbles-champagne
2025-06-05 20:16:17,716 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:16:22,727 - __main__ - INFO - Scroll attempt 1: height 3949
2025-06-05 20:16:24,734 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:16:24,734 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:16:24,826 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/bubbles-champagne
2025-06-05 20:16:24,891 - __main__ - INFO - Added JSON-LD event: Bubbles
2025-06-05 20:16:25,028 - __main__ - INFO - Found 1 events on promoter page bubbles-champagne
2025-06-05 20:16:25,028 - __main__ - ERROR - Error saving event 'Bubbles': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:25,029 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:16:30,176 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2009/06
2025-06-05 20:16:30,176 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2009/06
2025-06-05 20:16:34,131 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/tomorrowland-presents-dimitri-vegas-mike
2025-06-05 20:16:34,132 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/tomorrowland-presents-dimitri-vegas-mike
2025-06-05 20:16:34,132 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/tomorrowland-presents-dimitri-vegas-mike
2025-06-05 20:16:36,619 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:16:41,629 - __main__ - INFO - Scroll attempt 1: height 5810
2025-06-05 20:16:43,635 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:16:43,635 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:16:43,776 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/tomorrowland-presents-dimitri-vegas-mike
2025-06-05 20:16:43,956 - __main__ - INFO - Added JSON-LD event: Tomorrowland presents Dimitri Vegas &amp; Like Mike Opening Party
2025-06-05 20:16:43,956 - __main__ - INFO - Added JSON-LD event: Tomorrowland presents Dimitri Vegas &amp; Like Mike
2025-06-05 20:16:43,956 - __main__ - INFO - Added JSON-LD event: Tomorrowland presents Dimitri Vegas &amp; Like Mike Closing Party
2025-06-05 20:16:44,174 - __main__ - INFO - Found 3 events on promoter page tomorrowland-presents-dimitri-vegas-mike
2025-06-05 20:16:44,174 - __main__ - ERROR - Error saving event 'Tomorrowland presents Dimitri Vegas &amp; Like Mike Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:44,175 - __main__ - ERROR - Error saving event 'Tomorrowland presents Dimitri Vegas &amp; Like Mike': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:44,175 - __main__ - ERROR - Error saving event 'Tomorrowland presents Dimitri Vegas &amp; Like Mike Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:44,176 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:16:47,725 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/kaluki-528
2025-06-05 20:16:47,725 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/kaluki-528
2025-06-05 20:16:47,725 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/kaluki-528
2025-06-05 20:16:50,508 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:16:55,519 - __main__ - INFO - Scroll attempt 1: height 5118
2025-06-05 20:16:57,524 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:16:57,524 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:16:57,630 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/kaluki-528
2025-06-05 20:16:57,718 - __main__ - INFO - Added JSON-LD event: Kaluki
2025-06-05 20:16:57,971 - __main__ - INFO - Found 1 events on promoter page kaluki-528
2025-06-05 20:16:57,971 - __main__ - ERROR - Error saving event 'Kaluki': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:16:57,972 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:17:00,869 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:17:00,869 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:17:00,869 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:17:03,441 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:17:08,451 - __main__ - INFO - Scroll attempt 1: height 6767
2025-06-05 20:17:10,457 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:17:10,457 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:17:10,635 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:17:10,855 - __main__ - INFO - Added JSON-LD event: Nido
2025-06-05 20:17:10,856 - __main__ - INFO - Added JSON-LD event: Nido Winter Opening
2025-06-05 20:17:11,777 - __main__ - INFO - Found 2 events on promoter page nido
2025-06-05 20:17:11,777 - __main__ - ERROR - Error saving event 'Nido': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:11,778 - __main__ - ERROR - Error saving event 'Nido Winter Opening': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:11,778 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:17:17,199 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/craig-davids-ts5
2025-06-05 20:17:17,199 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/craig-davids-ts5
2025-06-05 20:17:17,199 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/craig-davids-ts5
2025-06-05 20:17:19,844 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:17:24,855 - __main__ - INFO - Scroll attempt 1: height 5287
2025-06-05 20:17:26,861 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:17:26,861 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:17:26,971 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/craig-davids-ts5
2025-06-05 20:17:27,089 - __main__ - INFO - Added JSON-LD event: Craig David's TS5 Opening Party
2025-06-05 20:17:27,089 - __main__ - INFO - Added JSON-LD event: Craig David's TS5 Pool Party
2025-06-05 20:17:27,089 - __main__ - INFO - Added JSON-LD event: Craig David's TS5 Closing Party
2025-06-05 20:17:27,248 - __main__ - INFO - Found 3 events on promoter page craig-davids-ts5
2025-06-05 20:17:27,249 - __main__ - ERROR - Error saving event 'Craig David's TS5 Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:27,249 - __main__ - ERROR - Error saving event 'Craig David's TS5 Pool Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:27,249 - __main__ - ERROR - Error saving event 'Craig David's TS5 Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:27,250 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:17:30,135 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/puro-reggaeton
2025-06-05 20:17:30,136 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/puro-reggaeton
2025-06-05 20:17:30,136 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/puro-reggaeton
2025-06-05 20:17:32,730 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:17:37,741 - __main__ - INFO - Scroll attempt 1: height 5742
2025-06-05 20:17:39,746 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:17:39,747 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:17:39,905 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/puro-reggaeton
2025-06-05 20:17:40,173 - __main__ - INFO - Added JSON-LD event: Puro Reggaeton Ibiza Opening Party
2025-06-05 20:17:40,173 - __main__ - INFO - Added JSON-LD event: Puro Reggaeton Ibiza
2025-06-05 20:17:40,173 - __main__ - INFO - Added JSON-LD event: Puro Reggaeton Ibiza Closing Party
2025-06-05 20:17:40,399 - __main__ - INFO - Found 3 events on promoter page puro-reggaeton
2025-06-05 20:17:40,399 - __main__ - ERROR - Error saving event 'Puro Reggaeton Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:40,400 - __main__ - ERROR - Error saving event 'Puro Reggaeton Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:40,400 - __main__ - ERROR - Error saving event 'Puro Reggaeton Ibiza Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:40,400 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:17:45,971 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/blanche-london
2025-06-05 20:17:45,971 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/blanche-london
2025-06-05 20:17:45,972 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/blanche-london
2025-06-05 20:17:48,464 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:17:53,475 - __main__ - INFO - Scroll attempt 1: height 4318
2025-06-05 20:17:55,480 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:17:55,480 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:17:55,600 - __main__ - WARNING - No year context found for https://www.ibiza-spotlight.com/night/promoters/blanche-london
2025-06-05 20:17:55,766 - __main__ - INFO - Added JSON-LD event: Blanche Ibiza Opening Party
2025-06-05 20:17:55,766 - __main__ - INFO - Added JSON-LD event: Blanche Ibiza
2025-06-05 20:17:55,766 - __main__ - INFO - Added JSON-LD event: Blanche Ibiza Closing Party
2025-06-05 20:17:55,933 - __main__ - INFO - Found 3 events on promoter page blanche-london
2025-06-05 20:17:55,933 - __main__ - ERROR - Error saving event 'Blanche Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:55,933 - __main__ - ERROR - Error saving event 'Blanche Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:55,934 - __main__ - ERROR - Error saving event 'Blanche Ibiza Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:17:55,934 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:18:01,078 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:18:01,079 - __main__ - INFO - Updated venue context from 'hard-rock-hotel' to 'tipic-formentera' for URL https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:18:01,079 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:18:01,079 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:18:03,519 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:18:08,531 - __main__ - INFO - Scroll attempt 1: height 4349
2025-06-05 20:18:10,536 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:18:10,536 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:18:10,636 - __main__ - INFO - Extracted 0 promoter URLs from https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:18:10,637 - __main__ - INFO - DEBUG: Found 0 promoter URLs from venue/club page 'tipic-formentera'
2025-06-05 20:18:10,637 - __main__ - WARNING - No promoter URLs found on venue/club page: https://www.ibiza-spotlight.com/night/venue/tipic-formentera
2025-06-05 20:18:15,509 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/pacha-pre-season-parties
2025-06-05 20:18:15,509 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/pacha-pre-season-parties
2025-06-05 20:18:15,509 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/pacha-pre-season-parties
2025-06-05 20:18:18,261 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:18:23,272 - __main__ - INFO - Scroll attempt 1: height 6111
2025-06-05 20:18:25,277 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:18:25,277 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:18:25,439 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/pacha-pre-season-parties
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Purple Disco Machine
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: ANOTR
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Ilario Alicante
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Dawn Patrol
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Franky Rizardo presents Flow
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Klsch &amp; Ida Engberg
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Maccabi
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Rossi. presents HOME//GRXWN
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Gordo
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Two &amp; A Half Cats
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Loco Dice
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Dixon B2B Ame B2B Jimi Jules
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Anjunadeep
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Honey Dijon
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: WhoMadeWho
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: KEINEMUSIK
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Mochakk
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Roger Sanchez
2025-06-05 20:18:25,568 - __main__ - INFO - Added JSON-LD event: Introducing... Baddest Behaviour
2025-06-05 20:18:34,771 - __main__ - INFO - Found 19 events on promoter page pacha-pre-season-parties
2025-06-05 20:18:34,771 - __main__ - ERROR - Error saving event 'Purple Disco Machine': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,772 - __main__ - ERROR - Error saving event 'ANOTR': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,772 - __main__ - ERROR - Error saving event 'Ilario Alicante': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,773 - __main__ - ERROR - Error saving event 'Dawn Patrol': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,773 - __main__ - ERROR - Error saving event 'Franky Rizardo presents Flow': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,773 - __main__ - ERROR - Error saving event 'Klsch &amp; Ida Engberg': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,774 - __main__ - ERROR - Error saving event 'Maccabi': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,774 - __main__ - ERROR - Error saving event 'Rossi. presents HOME//GRXWN': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,775 - __main__ - ERROR - Error saving event 'Gordo': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,775 - __main__ - ERROR - Error saving event 'Two &amp; A Half Cats': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,775 - __main__ - ERROR - Error saving event 'Loco Dice': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,776 - __main__ - ERROR - Error saving event 'Dixon B2B Ame B2B Jimi Jules': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,776 - __main__ - ERROR - Error saving event 'Anjunadeep': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,776 - __main__ - ERROR - Error saving event 'Honey Dijon': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,777 - __main__ - ERROR - Error saving event 'WhoMadeWho': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,777 - __main__ - ERROR - Error saving event 'KEINEMUSIK': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,778 - __main__ - ERROR - Error saving event 'Mochakk': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,778 - __main__ - ERROR - Error saving event 'Roger Sanchez': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,778 - __main__ - ERROR - Error saving event 'Introducing... Baddest Behaviour': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:34,779 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:18:38,974 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/el-paripe
2025-06-05 20:18:38,975 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/el-paripe
2025-06-05 20:18:38,975 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/el-paripe
2025-06-05 20:18:41,591 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:18:46,602 - __main__ - INFO - Scroll attempt 1: height 5837
2025-06-05 20:18:48,608 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:18:48,608 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:18:48,764 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/el-paripe
2025-06-05 20:18:48,984 - __main__ - INFO - Added JSON-LD event: El Parip Opening Party
2025-06-05 20:18:48,984 - __main__ - INFO - Added JSON-LD event: El Parip
2025-06-05 20:18:48,984 - __main__ - INFO - Added JSON-LD event: El Parip Closing Party
2025-06-05 20:18:49,202 - __main__ - INFO - Found 3 events on promoter page el-paripe
2025-06-05 20:18:49,202 - __main__ - ERROR - Error saving event 'El Parip Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:49,203 - __main__ - ERROR - Error saving event 'El Parip': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:49,203 - __main__ - ERROR - Error saving event 'El Parip Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:18:49,204 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:18:53,660 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2020/06
2025-06-05 20:18:53,661 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2020/06
2025-06-05 20:18:56,307 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/abode-eden
2025-06-05 20:18:56,307 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/abode-eden
2025-06-05 20:18:56,307 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/abode-eden
2025-06-05 20:18:59,612 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:19:04,626 - __main__ - INFO - Scroll attempt 1: height 7594
2025-06-05 20:19:06,631 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:19:06,632 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:19:06,877 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/abode-eden
2025-06-05 20:19:07,144 - __main__ - INFO - Added JSON-LD event: ABODE x CUE Opening Party
2025-06-05 20:19:07,144 - __main__ - INFO - Added JSON-LD event: ABODE x CUE
2025-06-05 20:19:07,144 - __main__ - INFO - Added JSON-LD event: ABODE x CUE Closing Party
2025-06-05 20:19:08,061 - __main__ - INFO - Found 3 events on promoter page abode-eden
2025-06-05 20:19:08,061 - __main__ - ERROR - Error saving event 'ABODE x CUE Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:08,062 - __main__ - ERROR - Error saving event 'ABODE x CUE': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:08,062 - __main__ - ERROR - Error saving event 'ABODE x CUE Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:08,063 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:19:12,957 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/drama-club
2025-06-05 20:19:12,957 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/drama-club
2025-06-05 20:19:12,957 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/drama-club
2025-06-05 20:19:16,166 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:19:21,177 - __main__ - INFO - Scroll attempt 1: height 4522
2025-06-05 20:19:23,182 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:19:23,182 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:19:23,283 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/drama-club
2025-06-05 20:19:23,358 - __main__ - INFO - Added JSON-LD event: Drama Club
2025-06-05 20:19:23,458 - __main__ - INFO - Found 1 events on promoter page drama-club
2025-06-05 20:19:23,458 - __main__ - ERROR - Error saving event 'Drama Club': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:23,459 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:19:28,216 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/tiempo-nomis
2025-06-05 20:19:28,216 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/tiempo-nomis
2025-06-05 20:19:28,216 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/tiempo-nomis
2025-06-05 20:19:30,679 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:19:35,690 - __main__ - INFO - Scroll attempt 1: height 4497
2025-06-05 20:19:37,695 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:19:37,695 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:19:37,814 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/tiempo-nomis
2025-06-05 20:19:37,965 - __main__ - INFO - Added JSON-LD event: Tiempo by Nomis Opening Party
2025-06-05 20:19:37,965 - __main__ - INFO - Added JSON-LD event: Tiempo by Nomis
2025-06-05 20:19:37,965 - __main__ - INFO - Added JSON-LD event: Tiempo by Nomis Closing Party
2025-06-05 20:19:38,166 - __main__ - INFO - Found 3 events on promoter page tiempo-nomis
2025-06-05 20:19:38,166 - __main__ - ERROR - Error saving event 'Tiempo by Nomis Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:38,167 - __main__ - ERROR - Error saving event 'Tiempo by Nomis': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:38,167 - __main__ - ERROR - Error saving event 'Tiempo by Nomis Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:38,168 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:19:42,053 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:19:42,053 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:19:42,053 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:19:44,608 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:19:49,620 - __main__ - INFO - Scroll attempt 1: height 6420
2025-06-05 20:19:51,626 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:19:51,626 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:19:51,771 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:19:51,995 - __main__ - INFO - Added JSON-LD event: Float Your Boat
2025-06-05 20:19:52,155 - __main__ - INFO - Found 1 events on promoter page float-your-boat-sunset-experience
2025-06-05 20:19:52,156 - __main__ - ERROR - Error saving event 'Float Your Boat': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:19:52,156 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:19:55,058 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/thursdays-es-paradis
2025-06-05 20:19:55,058 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/thursdays-es-paradis
2025-06-05 20:19:55,058 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/thursdays-es-paradis
2025-06-05 20:19:57,591 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:20:02,602 - __main__ - INFO - Scroll attempt 1: height 5569
2025-06-05 20:20:04,608 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:20:04,608 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:20:04,752 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/thursdays-es-paradis
2025-06-05 20:20:04,984 - __main__ - INFO - Added JSON-LD event: Es Paradis
2025-06-05 20:20:04,985 - __main__ - INFO - Added JSON-LD event: Fabienne's Ultimate '90s Experience Opening Party
2025-06-05 20:20:04,985 - __main__ - INFO - Added JSON-LD event: Fabienne's Ultimate '90s Experience
2025-06-05 20:20:04,985 - __main__ - INFO - Added JSON-LD event: Fabienne's Ultimate '90s Experience Closing Party
2025-06-05 20:20:05,211 - __main__ - INFO - Found 4 events on promoter page thursdays-es-paradis
2025-06-05 20:20:05,211 - __main__ - ERROR - Error saving event 'Es Paradis': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:05,212 - __main__ - ERROR - Error saving event 'Fabienne's Ultimate '90s Experience Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:05,212 - __main__ - ERROR - Error saving event 'Fabienne's Ultimate '90s Experience': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:05,213 - __main__ - ERROR - Error saving event 'Fabienne's Ultimate '90s Experience Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:05,213 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:20:08,992 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=05/06/2025-11/06/2025
2025-06-05 20:20:08,993 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=05/06/2025-11/06/2025
2025-06-05 20:20:14,580 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:20:14,580 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:20:14,581 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:20:16,947 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:20:21,958 - __main__ - INFO - Scroll attempt 1: height 10344
2025-06-05 20:20:23,963 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:20:23,963 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:20:24,248 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:20:24,813 - __main__ - INFO - Added JSON-LD event: Five Star Boat Party
2025-06-05 20:20:24,813 - __main__ - INFO - Added JSON-LD event: Five Star Boat Party | Easter Sailing
2025-06-05 20:20:25,228 - __main__ - INFO - Found 2 events on promoter page five-star-boat-party-ibiza-boat-club
2025-06-05 20:20:25,228 - __main__ - ERROR - Error saving event 'Five Star Boat Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:25,228 - __main__ - ERROR - Error saving event 'Five Star Boat Party | Easter Sailing': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:25,229 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:20:28,215 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/pandora
2025-06-05 20:20:28,215 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/pandora
2025-06-05 20:20:28,215 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/pandora
2025-06-05 20:20:30,713 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:20:35,724 - __main__ - INFO - Scroll attempt 1: height 4583
2025-06-05 20:20:37,729 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:20:37,729 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:20:37,850 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/pandora
2025-06-05 20:20:38,004 - __main__ - INFO - Added JSON-LD event: Pandora Opening Party
2025-06-05 20:20:38,004 - __main__ - INFO - Added JSON-LD event: Pandora
2025-06-05 20:20:38,004 - __main__ - INFO - Added JSON-LD event: Pandora Closing Party
2025-06-05 20:20:38,213 - __main__ - INFO - Found 3 events on promoter page pandora
2025-06-05 20:20:38,213 - __main__ - ERROR - Error saving event 'Pandora Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:38,214 - __main__ - ERROR - Error saving event 'Pandora': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:38,214 - __main__ - ERROR - Error saving event 'Pandora Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:38,215 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:20:42,127 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=02/06/2025-08/06/2025
2025-06-05 20:20:42,127 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=02/06/2025-08/06/2025
2025-06-05 20:20:46,429 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/reboot-rocks
2025-06-05 20:20:46,429 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/reboot-rocks
2025-06-05 20:20:46,429 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/reboot-rocks
2025-06-05 20:20:48,974 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:20:53,986 - __main__ - INFO - Scroll attempt 1: height 5537
2025-06-05 20:20:55,991 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:20:55,991 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:20:56,147 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/reboot-rocks
2025-06-05 20:20:56,376 - __main__ - INFO - Added JSON-LD event: Reboot Rocks Opening Party
2025-06-05 20:20:56,376 - __main__ - INFO - Added JSON-LD event: Reboot Rocks
2025-06-05 20:20:56,376 - __main__ - INFO - Added JSON-LD event: Reboot Rocks Closing Party
2025-06-05 20:20:56,588 - __main__ - INFO - Found 3 events on promoter page reboot-rocks
2025-06-05 20:20:56,588 - __main__ - ERROR - Error saving event 'Reboot Rocks Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:56,589 - __main__ - ERROR - Error saving event 'Reboot Rocks': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:56,589 - __main__ - ERROR - Error saving event 'Reboot Rocks Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:20:56,590 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:21:01,823 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:21:01,823 - __main__ - INFO - Updated venue context from 'tipic-formentera' to 'playa-soleil-tnl' for URL https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:21:01,823 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:21:01,823 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:21:04,393 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:21:09,404 - __main__ - INFO - Scroll attempt 1: height 5727
2025-06-05 20:21:11,409 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:21:11,409 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:21:11,536 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:21:11,536 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/all-i-need-playa-soleil
2025-06-05 20:21:11,536 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/la-troya-playa-soleil
2025-06-05 20:21:11,536 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/la-troya-playa-soleil
2025-06-05 20:21:11,536 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/bazar-playa-soleil
2025-06-05 20:21:11,537 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/bazar-playa-soleil
2025-06-05 20:21:11,537 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/rumors-playa-soleil
2025-06-05 20:21:11,537 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/rumors-playa-soleil
2025-06-05 20:21:11,540 - __main__ - INFO - Extracted 4 promoter URLs from https://www.ibiza-spotlight.com/night/venue/playa-soleil-tnl
2025-06-05 20:21:11,540 - __main__ - INFO - DEBUG: Found 4 promoter URLs from venue/club page 'playa-soleil-tnl'
2025-06-05 20:21:11,540 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/rumors-playa-soleil
2025-06-05 20:21:11,540 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/bazar-playa-soleil
2025-06-05 20:21:11,540 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/la-troya-playa-soleil
2025-06-05 20:21:17,243 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2021/06
2025-06-05 20:21:17,243 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2021/06
2025-06-05 20:21:20,867 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/nothing-trouble-eden
2025-06-05 20:21:20,867 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/nothing-trouble-eden
2025-06-05 20:21:20,867 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/nothing-trouble-eden
2025-06-05 20:21:23,835 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:21:28,846 - __main__ - INFO - Scroll attempt 1: height 5587
2025-06-05 20:21:30,851 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:21:30,851 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:21:30,974 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/nothing-trouble-eden
2025-06-05 20:21:31,121 - __main__ - INFO - Added JSON-LD event: Nothing But Trouble Opening Party
2025-06-05 20:21:31,121 - __main__ - INFO - Added JSON-LD event: Nothing But Trouble
2025-06-05 20:21:31,121 - __main__ - INFO - Added JSON-LD event: Nothing But Trouble Closing Party
2025-06-05 20:21:31,309 - __main__ - INFO - Found 3 events on promoter page nothing-trouble-eden
2025-06-05 20:21:31,309 - __main__ - ERROR - Error saving event 'Nothing But Trouble Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:21:31,310 - __main__ - ERROR - Error saving event 'Nothing But Trouble': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:21:31,310 - __main__ - ERROR - Error saving event 'Nothing But Trouble Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:21:31,311 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:21:37,296 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/05/26
2025-06-05 20:21:37,296 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/05/26
2025-06-05 20:21:41,181 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/sundays-es-paradis
2025-06-05 20:21:41,181 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/sundays-es-paradis
2025-06-05 20:21:41,181 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/sundays-es-paradis
2025-06-05 20:21:43,748 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:21:48,758 - __main__ - INFO - Scroll attempt 1: height 5330
2025-06-05 20:21:50,763 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:21:50,763 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:21:50,894 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/sundays-es-paradis
2025-06-05 20:21:51,118 - __main__ - INFO - Added JSON-LD event: Clsico
2025-06-05 20:21:51,118 - __main__ - INFO - Added JSON-LD event: SaSo Deluxe Opening Party
2025-06-05 20:21:51,118 - __main__ - INFO - Added JSON-LD event: SaSo Deluxe
2025-06-05 20:21:51,118 - __main__ - INFO - Added JSON-LD event: SaSo Deluxe Closing Party
2025-06-05 20:21:51,341 - __main__ - INFO - Found 4 events on promoter page sundays-es-paradis
2025-06-05 20:21:51,341 - __main__ - ERROR - Error saving event 'Clsico': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:21:51,342 - __main__ - ERROR - Error saving event 'SaSo Deluxe Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:21:51,342 - __main__ - ERROR - Error saving event 'SaSo Deluxe': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:21:51,343 - __main__ - ERROR - Error saving event 'SaSo Deluxe Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:21:51,343 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:21:54,259 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:21:54,259 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:21:54,259 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:21:57,043 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:22:02,055 - __main__ - INFO - Scroll attempt 1: height 5652
2025-06-05 20:22:04,060 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:22:04,060 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:22:04,173 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:22:04,299 - __main__ - INFO - Added JSON-LD event: Sven Vth presents T.R.A.N.C.E Easter Special
2025-06-05 20:22:04,299 - __main__ - INFO - Added JSON-LD event: Sven Vth presents T.R.A.N.C.E Opening Party
2025-06-05 20:22:04,299 - __main__ - INFO - Added JSON-LD event: Sven Vth presents T.R.A.N.C.E
2025-06-05 20:22:04,299 - __main__ - INFO - Added JSON-LD event: Sven Vth presents T.R.A.N.C.E Closing Party
2025-06-05 20:22:04,901 - __main__ - INFO - Found 4 events on promoter page sven-vath-akasha
2025-06-05 20:22:04,901 - __main__ - ERROR - Error saving event 'Sven Vth presents T.R.A.N.C.E Easter Special': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:04,902 - __main__ - ERROR - Error saving event 'Sven Vth presents T.R.A.N.C.E Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:04,902 - __main__ - ERROR - Error saving event 'Sven Vth presents T.R.A.N.C.E': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:04,903 - __main__ - ERROR - Error saving event 'Sven Vth presents T.R.A.N.C.E Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:04,903 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:22:08,427 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2022/06
2025-06-05 20:22:08,427 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2022/06
2025-06-05 20:22:13,326 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/defected
2025-06-05 20:22:13,326 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/defected
2025-06-05 20:22:13,327 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/defected
2025-06-05 20:22:16,137 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:22:21,146 - __main__ - INFO - Scroll attempt 1: height 6787
2025-06-05 20:22:23,152 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:22:23,152 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:22:23,324 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/defected
2025-06-05 20:22:23,605 - __main__ - INFO - Added JSON-LD event: Defected Opening Party
2025-06-05 20:22:23,605 - __main__ - INFO - Added JSON-LD event: Defected
2025-06-05 20:22:23,605 - __main__ - INFO - Added JSON-LD event: Defected Closing Party
2025-06-05 20:22:23,877 - __main__ - INFO - Found 3 events on promoter page defected
2025-06-05 20:22:23,878 - __main__ - ERROR - Error saving event 'Defected Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:23,878 - __main__ - ERROR - Error saving event 'Defected': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:23,879 - __main__ - ERROR - Error saving event 'Defected Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:23,879 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:22:28,411 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:22:28,411 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:22:28,411 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:22:31,011 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:22:36,021 - __main__ - INFO - Scroll attempt 1: height 7026
2025-06-05 20:22:38,027 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:22:38,027 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:22:38,192 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:22:38,443 - __main__ - INFO - Added JSON-LD event: Namaste
2025-06-05 20:22:38,443 - __main__ - INFO - Added JSON-LD event: Namaste Primavera Sessions
2025-06-05 20:22:38,443 - __main__ - INFO - Added JSON-LD event: Namaste Opening Party
2025-06-05 20:22:38,688 - __main__ - INFO - Found 3 events on promoter page namaste
2025-06-05 20:22:38,688 - __main__ - ERROR - Error saving event 'Namaste': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:38,689 - __main__ - ERROR - Error saving event 'Namaste Primavera Sessions': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:38,689 - __main__ - ERROR - Error saving event 'Namaste Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:38,690 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:22:43,824 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.de/night/events/2025/06
2025-06-05 20:22:43,824 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.de/night/events/2025/06
2025-06-05 20:22:47,268 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:22:47,269 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:22:47,269 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:22:49,780 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:22:54,790 - __main__ - INFO - Scroll attempt 1: height 8341
2025-06-05 20:22:56,795 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:22:56,795 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:22:56,982 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:22:57,325 - __main__ - INFO - Added JSON-LD event: Pukka Up Sunset Boat Party
2025-06-05 20:22:57,502 - __main__ - INFO - Found 1 events on promoter page pukka_up_i.htm
2025-06-05 20:22:57,502 - __main__ - ERROR - Error saving event 'Pukka Up Sunset Boat Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:22:57,503 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:23:02,325 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/heavy-house-society-528
2025-06-05 20:23:02,325 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/heavy-house-society-528
2025-06-05 20:23:02,325 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/heavy-house-society-528
2025-06-05 20:23:05,021 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:23:10,031 - __main__ - INFO - Scroll attempt 1: height 4762
2025-06-05 20:23:12,037 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:23:12,037 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:23:12,215 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/heavy-house-society-528
2025-06-05 20:23:12,285 - __main__ - INFO - Added JSON-LD event: Heavy House Society
2025-06-05 20:23:12,456 - __main__ - INFO - Found 1 events on promoter page heavy-house-society-528
2025-06-05 20:23:12,456 - __main__ - ERROR - Error saving event 'Heavy House Society': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:23:12,457 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:23:17,964 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:23:17,964 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:23:17,964 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:23:20,487 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:23:25,498 - __main__ - INFO - Scroll attempt 1: height 5240
2025-06-05 20:23:27,503 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:23:27,503 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:23:27,600 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:23:27,667 - __main__ - INFO - Added JSON-LD event: [UNVRS] Opening Party
2025-06-05 20:23:27,748 - __main__ - INFO - Found 1 events on promoter page unvrs-opening-party
2025-06-05 20:23:27,748 - __main__ - ERROR - Error saving event '[UNVRS] Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:23:27,749 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:23:32,258 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:23:32,259 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:23:32,259 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:23:34,851 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:23:39,861 - __main__ - INFO - Scroll attempt 1: height 4938
2025-06-05 20:23:41,866 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:23:41,866 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:23:41,981 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:23:42,106 - __main__ - INFO - Added JSON-LD event: Appetite Ibiza
2025-06-05 20:23:42,214 - __main__ - INFO - Found 1 events on promoter page appetite-chinois
2025-06-05 20:23:42,214 - __main__ - ERROR - Error saving event 'Appetite Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:23:42,215 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:23:45,978 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=16/06/2025-22/06/2025
2025-06-05 20:23:45,978 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=16/06/2025-22/06/2025
2025-06-05 20:23:51,033 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:23:51,033 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:23:51,033 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:23:53,956 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:23:58,967 - __main__ - INFO - Scroll attempt 1: height 4921
2025-06-05 20:24:00,972 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:24:00,972 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:24:01,102 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:24:01,250 - __main__ - INFO - Added JSON-LD event: UTOPIC
2025-06-05 20:24:01,483 - __main__ - INFO - Found 1 events on promoter page utopic
2025-06-05 20:24:01,484 - __main__ - ERROR - Error saving event 'UTOPIC': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:01,484 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:24:04,225 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06/06
2025-06-05 20:24:04,225 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06/06
2025-06-05 20:24:08,012 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/sin-sundays
2025-06-05 20:24:08,012 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/sin-sundays
2025-06-05 20:24:08,012 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/sin-sundays
2025-06-05 20:24:10,830 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:24:15,842 - __main__ - INFO - Scroll attempt 1: height 5099
2025-06-05 20:24:17,847 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:24:17,847 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:24:17,959 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/sin-sundays
2025-06-05 20:24:18,085 - __main__ - INFO - Added JSON-LD event: SIN Sundays
2025-06-05 20:24:18,179 - __main__ - INFO - Found 1 events on promoter page sin-sundays
2025-06-05 20:24:18,179 - __main__ - ERROR - Error saving event 'SIN Sundays': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:18,180 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:24:22,366 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2011/06
2025-06-05 20:24:22,366 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2011/06
2025-06-05 20:24:25,101 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/daydreamers
2025-06-05 20:24:25,102 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/daydreamers
2025-06-05 20:24:25,102 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/daydreamers
2025-06-05 20:24:27,625 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:24:32,636 - __main__ - INFO - Scroll attempt 1: height 5926
2025-06-05 20:24:34,641 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:24:34,641 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:24:34,785 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/daydreamers
2025-06-05 20:24:35,013 - __main__ - INFO - Added JSON-LD event: Daydreamers Opening Party
2025-06-05 20:24:35,013 - __main__ - INFO - Added JSON-LD event: Daydreamers Pool Party
2025-06-05 20:24:35,013 - __main__ - INFO - Added JSON-LD event: Ben Hemsley presents beb
2025-06-05 20:24:35,013 - __main__ - INFO - Added JSON-LD event: Unfussy presents Morgan Seatree
2025-06-05 20:24:35,013 - __main__ - INFO - Added JSON-LD event: BBC Radio 1 Dance X
2025-06-05 20:24:35,013 - __main__ - INFO - Added JSON-LD event: Billy Gillies
2025-06-05 20:24:35,013 - __main__ - INFO - Added JSON-LD event: Daydreamers Closing Party
2025-06-05 20:24:39,884 - __main__ - INFO - Found 7 events on promoter page daydreamers
2025-06-05 20:24:39,884 - __main__ - ERROR - Error saving event 'Daydreamers Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:39,884 - __main__ - ERROR - Error saving event 'Daydreamers Pool Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:39,885 - __main__ - ERROR - Error saving event 'Ben Hemsley presents beb': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:39,885 - __main__ - ERROR - Error saving event 'Unfussy presents Morgan Seatree': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:39,886 - __main__ - ERROR - Error saving event 'BBC Radio 1 Dance X': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:39,886 - __main__ - ERROR - Error saving event 'Billy Gillies': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:39,887 - __main__ - ERROR - Error saving event 'Daydreamers Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:39,887 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:24:45,295 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/soul-heaven
2025-06-05 20:24:45,295 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/soul-heaven
2025-06-05 20:24:45,295 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/soul-heaven
2025-06-05 20:24:48,016 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:24:53,027 - __main__ - INFO - Scroll attempt 1: height 6063
2025-06-05 20:24:55,033 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:24:55,033 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:24:55,184 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/soul-heaven
2025-06-05 20:24:55,394 - __main__ - INFO - Added JSON-LD event: Soul Heaven Opening Party
2025-06-05 20:24:55,394 - __main__ - INFO - Added JSON-LD event: Soul Heaven
2025-06-05 20:24:55,394 - __main__ - INFO - Added JSON-LD event: Soul Heaven Closing Party
2025-06-05 20:24:55,628 - __main__ - INFO - Found 3 events on promoter page soul-heaven
2025-06-05 20:24:55,628 - __main__ - ERROR - Error saving event 'Soul Heaven Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:55,629 - __main__ - ERROR - Error saving event 'Soul Heaven': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:55,629 - __main__ - ERROR - Error saving event 'Soul Heaven Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:24:55,630 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:24:58,577 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:24:58,578 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:24:58,578 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:25:01,183 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:25:06,196 - __main__ - INFO - Scroll attempt 1: height 6404
2025-06-05 20:25:08,201 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:25:08,201 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:25:08,352 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:25:08,574 - __main__ - INFO - Added JSON-LD event: Supernova Opening Party
2025-06-05 20:25:08,574 - __main__ - INFO - Added JSON-LD event: Supernova
2025-06-05 20:25:08,775 - __main__ - INFO - Found 2 events on promoter page supernova-las-dalias
2025-06-05 20:25:08,775 - __main__ - ERROR - Error saving event 'Supernova Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:25:08,775 - __main__ - ERROR - Error saving event 'Supernova': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:25:08,776 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:25:11,433 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/fiesta-del-agua
2025-06-05 20:25:11,433 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/fiesta-del-agua
2025-06-05 20:25:11,433 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/fiesta-del-agua
2025-06-05 20:25:15,197 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:25:20,208 - __main__ - INFO - Scroll attempt 1: height 6777
2025-06-05 20:25:22,213 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:25:22,213 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:25:22,357 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/fiesta-del-agua
2025-06-05 20:25:22,634 - __main__ - INFO - Added JSON-LD event: Fiesta del Agua Opening Party
2025-06-05 20:25:22,634 - __main__ - INFO - Added JSON-LD event: Fiesta del Agua
2025-06-05 20:25:22,634 - __main__ - INFO - Added JSON-LD event: Fiesta del Agua Closing Party
2025-06-05 20:25:22,843 - __main__ - INFO - Found 3 events on promoter page fiesta-del-agua
2025-06-05 20:25:22,843 - __main__ - ERROR - Error saving event 'Fiesta del Agua Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:25:22,843 - __main__ - ERROR - Error saving event 'Fiesta del Agua': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:25:22,844 - __main__ - ERROR - Error saving event 'Fiesta del Agua Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:25:22,844 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:25:27,549 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/10
2025-06-05 20:25:27,549 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/10
2025-06-05 20:25:31,514 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2018/06
2025-06-05 20:25:31,515 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2018/06
2025-06-05 20:25:36,447 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:25:36,447 - __main__ - INFO - Updated venue context from 'playa-soleil-tnl' to 'chinois-ibiza' for URL https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:25:36,447 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:25:36,447 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:25:39,187 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:25:44,197 - __main__ - INFO - Scroll attempt 1: height 6293
2025-06-05 20:25:46,203 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:25:46,203 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/trip-club-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/trip-club-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/appetite-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/honey-dijon-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/honey-dijon-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/sondela-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/sondela-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/francis-mercier-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/francis-mercier-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/saga-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/saga-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/kerri-chandler-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/kerri-chandler-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/shimza-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/shimza-chinois
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/chinois-ibiza-pre-season-parties
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/chinois-ibiza-pre-season-parties
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/ims-dalt-vila-afterparty
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/ims-dalt-vila-afterparty
2025-06-05 20:25:46,355 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/club-chinois-opening-party
2025-06-05 20:25:46,356 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/club-chinois-opening-party
2025-06-05 20:25:46,359 - __main__ - INFO - Extracted 13 promoter URLs from https://www.ibiza-spotlight.com/night/venue/chinois-ibiza
2025-06-05 20:25:46,359 - __main__ - INFO - DEBUG: Found 13 promoter URLs from venue/club page 'chinois-ibiza'
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/saga-chinois
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/trip-club-chinois
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/ims-dalt-vila-afterparty
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/honey-dijon-chinois
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/shimza-chinois
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/chinois-ibiza-pre-season-parties
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/francis-mercier-chinois
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/sondela-chinois
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/club-chinois-opening-party
2025-06-05 20:25:46,359 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/kerri-chandler-chinois
2025-06-05 20:25:49,729 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=30/06/2025-06/07/2025
2025-06-05 20:25:49,729 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=30/06/2025-06/07/2025
2025-06-05 20:25:54,301 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:25:54,302 - __main__ - INFO - Updated venue context from 'chinois-ibiza' to 'hi-ibiza' for URL https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:25:54,302 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:25:54,302 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:25:57,130 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:26:02,140 - __main__ - INFO - Scroll attempt 1: height 6508
2025-06-05 20:26:04,145 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:26:04,145 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/black-coffee
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/our-house-hi-ibiza
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/our-house-hi-ibiza
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/martinez-brothers
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/martinez-brothers
2025-06-05 20:26:04,271 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/blackworks-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/blackworks-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/john-summit-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/john-summit-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hugel-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hugel-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/dom-dolla
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/dom-dolla
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/metamorfosi-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/metamorfosi-hi
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/glitterbox-special
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/glitterbox-special
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hi-ibiza-opening-party-2025
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hi-ibiza-opening-party-2025
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/paco-osuna-presents-now-here
2025-06-05 20:26:04,272 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/paco-osuna-presents-now-here
2025-06-05 20:26:04,276 - __main__ - INFO - Extracted 13 promoter URLs from https://www.ibiza-spotlight.com/night/venue/hi-ibiza
2025-06-05 20:26:04,276 - __main__ - INFO - DEBUG: Found 13 promoter URLs from venue/club page 'hi-ibiza'
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/martinez-brothers
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/blackworks-hi
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/paco-osuna-presents-now-here
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/glitterbox-special
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/hi-ibiza-opening-party-2025
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/our-house-hi-ibiza
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/john-summit-hi
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/hugel-hi
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/metamorfosi-hi
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/dom-dolla
2025-06-05 20:26:04,276 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:26:08,407 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/08
2025-06-05 20:26:08,407 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/08
2025-06-05 20:26:13,639 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/05?daterange=19/05/2025-25/05/2025
2025-06-05 20:26:13,639 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/05?daterange=19/05/2025-25/05/2025
2025-06-05 20:26:18,739 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2010/06
2025-06-05 20:26:18,739 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2010/06
2025-06-05 20:26:22,604 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/calvin-harris-friday
2025-06-05 20:26:22,604 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/calvin-harris-friday
2025-06-05 20:26:22,604 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/calvin-harris-friday
2025-06-05 20:26:25,150 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:26:30,161 - __main__ - INFO - Scroll attempt 1: height 5288
2025-06-05 20:26:32,166 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:26:32,166 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:26:32,297 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/calvin-harris-friday
2025-06-05 20:26:32,416 - __main__ - INFO - Added JSON-LD event: Calvin Harris Opening Party | Friday
2025-06-05 20:26:32,416 - __main__ - INFO - Added JSON-LD event: Calvin Harris  | Friday
2025-06-05 20:26:32,416 - __main__ - INFO - Added JSON-LD event: Calvin Harris Closing Party | Friday
2025-06-05 20:26:32,823 - __main__ - INFO - Found 3 events on promoter page calvin-harris-friday
2025-06-05 20:26:32,823 - __main__ - ERROR - Error saving event 'Calvin Harris Opening Party | Friday': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:26:32,823 - __main__ - ERROR - Error saving event 'Calvin Harris  | Friday': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:26:32,824 - __main__ - ERROR - Error saving event 'Calvin Harris Closing Party | Friday': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:26:32,825 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:26:37,926 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/music-on
2025-06-05 20:26:37,926 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/music-on
2025-06-05 20:26:37,926 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/music-on
2025-06-05 20:26:40,671 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:26:45,680 - __main__ - INFO - Scroll attempt 1: height 7269
2025-06-05 20:26:47,686 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:26:47,686 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:26:47,876 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/music-on
2025-06-05 20:26:48,236 - __main__ - INFO - Added JSON-LD event: Music On Opening Party
2025-06-05 20:26:48,236 - __main__ - INFO - Added JSON-LD event: Music On
2025-06-05 20:26:48,236 - __main__ - INFO - Added JSON-LD event: Music On Closing Party | Part One
2025-06-05 20:26:48,236 - __main__ - INFO - Added JSON-LD event: Music On Closing Party | Part Two
2025-06-05 20:26:48,567 - __main__ - INFO - Found 4 events on promoter page music-on
2025-06-05 20:26:48,567 - __main__ - ERROR - Error saving event 'Music On Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:26:48,568 - __main__ - ERROR - Error saving event 'Music On': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:26:48,568 - __main__ - ERROR - Error saving event 'Music On Closing Party | Part One': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:26:48,569 - __main__ - ERROR - Error saving event 'Music On Closing Party | Part Two': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:26:48,569 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:26:52,163 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:26:52,163 - __main__ - INFO - Updated venue context from 'hi-ibiza' to 'boat-parties-playa-den-bossa' for URL https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:26:52,164 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:26:52,164 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:26:54,617 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:26:59,628 - __main__ - INFO - Scroll attempt 1: height 5268
2025-06-05 20:27:01,634 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:27:01,634 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/five-star-boat-party-ibiza-boat-club
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/ibiza-boat-club-formentera
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:27:01,760 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/aftersun-ibiza-ibiza-boat-club
2025-06-05 20:27:01,764 - __main__ - INFO - Extracted 4 promoter URLs from https://www.ibiza-spotlight.com/night/venue/boat-parties-playa-den-bossa
2025-06-05 20:27:01,764 - __main__ - INFO - DEBUG: Found 4 promoter URLs from venue/club page 'boat-parties-playa-den-bossa'
2025-06-05 20:27:01,764 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:27:07,310 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:27:07,311 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:27:07,311 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:27:10,372 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:27:15,383 - __main__ - INFO - Scroll attempt 1: height 12050
2025-06-05 20:27:17,388 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:27:17,388 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:27:17,704 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:27:18,286 - __main__ - INFO - Added JSON-LD event: Oceanbeat Ibiza Afternoon Boat Party
2025-06-05 20:27:19,181 - __main__ - INFO - Found 1 events on promoter page oceanbeat-ibiza-boat-party
2025-06-05 20:27:19,181 - __main__ - ERROR - Error saving event 'Oceanbeat Ibiza Afternoon Boat Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:27:19,181 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:27:23,964 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2014/06
2025-06-05 20:27:23,965 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2014/06
2025-06-05 20:27:26,532 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2024/06
2025-06-05 20:27:26,532 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2024/06
2025-06-05 20:27:30,827 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2015/06
2025-06-05 20:27:30,827 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2015/06
2025-06-05 20:27:35,548 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:27:35,548 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:27:35,548 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:27:38,676 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:27:43,687 - __main__ - INFO - Scroll attempt 1: height 6141
2025-06-05 20:27:45,693 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:27:45,693 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:27:45,845 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:27:46,110 - __main__ - INFO - Added JSON-LD event: Claptone presents The Masquerade Opening Party
2025-06-05 20:27:46,110 - __main__ - INFO - Added JSON-LD event: Claptone presents The Masquerade
2025-06-05 20:27:46,110 - __main__ - INFO - Added JSON-LD event: Claptone presents The Masquerade Closing Party
2025-06-05 20:27:46,347 - __main__ - INFO - Found 3 events on promoter page masquerade-chinois
2025-06-05 20:27:46,347 - __main__ - ERROR - Error saving event 'Claptone presents The Masquerade Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:27:46,347 - __main__ - ERROR - Error saving event 'Claptone presents The Masquerade': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:27:46,348 - __main__ - ERROR - Error saving event 'Claptone presents The Masquerade Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:27:46,348 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:27:51,715 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/one
2025-06-05 20:27:51,715 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/one
2025-06-05 20:27:51,715 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/one
2025-06-05 20:27:54,829 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:27:59,840 - __main__ - INFO - Scroll attempt 1: height 6495
2025-06-05 20:28:01,844 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:28:01,844 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:28:02,070 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/one
2025-06-05 20:28:02,300 - __main__ - INFO - Added JSON-LD event: ON111 Opening Party
2025-06-05 20:28:02,301 - __main__ - INFO - Added JSON-LD event: ON111
2025-06-05 20:28:02,301 - __main__ - INFO - Added JSON-LD event: ON111 | Old Skool Jam
2025-06-05 20:28:02,301 - __main__ - INFO - Added JSON-LD event: ON111 | R&amp;B Lovers
2025-06-05 20:28:02,301 - __main__ - INFO - Added JSON-LD event: ON111 | Mayfair Sessions
2025-06-05 20:28:02,301 - __main__ - INFO - Added JSON-LD event: ON111 | Nuage
2025-06-05 20:28:02,301 - __main__ - INFO - Added JSON-LD event: ON111 | Dankie Sounds
2025-06-05 20:28:02,301 - __main__ - INFO - Added JSON-LD event: ON111 Closing Party
2025-06-05 20:28:02,793 - __main__ - INFO - Found 8 events on promoter page one
2025-06-05 20:28:02,793 - __main__ - ERROR - Error saving event 'ON111 Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,794 - __main__ - ERROR - Error saving event 'ON111': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,794 - __main__ - ERROR - Error saving event 'ON111 | Old Skool Jam': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,794 - __main__ - ERROR - Error saving event 'ON111 | R&amp;B Lovers': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,795 - __main__ - ERROR - Error saving event 'ON111 | Mayfair Sessions': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,795 - __main__ - ERROR - Error saving event 'ON111 | Nuage': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,795 - __main__ - ERROR - Error saving event 'ON111 | Dankie Sounds': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,796 - __main__ - ERROR - Error saving event 'ON111 Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:02,796 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:28:07,261 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:28:07,261 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:28:07,261 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:28:10,029 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:28:15,040 - __main__ - INFO - Scroll attempt 1: height 5533
2025-06-05 20:28:17,045 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:28:17,046 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:28:17,182 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Acid Pauli
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Maceo Plex
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Roger Sanchez
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois Presents
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Joris Voorn
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Sam Divine
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Butch
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Dennis Ferrer
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Portside After Party
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: Chinois presents Jan Blomqvist
2025-06-05 20:28:17,339 - __main__ - INFO - Added JSON-LD event: SG Lewis presents Forever Days
2025-06-05 20:28:17,824 - __main__ - INFO - Found 11 events on promoter page chinois-presents
2025-06-05 20:28:17,824 - __main__ - ERROR - Error saving event 'Chinois presents Acid Pauli': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,824 - __main__ - ERROR - Error saving event 'Chinois presents Maceo Plex': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,825 - __main__ - ERROR - Error saving event 'Chinois presents Roger Sanchez': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,825 - __main__ - ERROR - Error saving event 'Chinois Presents': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,826 - __main__ - ERROR - Error saving event 'Chinois presents Joris Voorn': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,826 - __main__ - ERROR - Error saving event 'Chinois presents Sam Divine': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,826 - __main__ - ERROR - Error saving event 'Chinois presents Butch': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,827 - __main__ - ERROR - Error saving event 'Chinois presents Dennis Ferrer': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,827 - __main__ - ERROR - Error saving event 'Portside After Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,827 - __main__ - ERROR - Error saving event 'Chinois presents Jan Blomqvist': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,828 - __main__ - ERROR - Error saving event 'SG Lewis presents Forever Days': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:17,828 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:28:21,437 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:28:21,437 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:28:21,437 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:28:24,130 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:28:29,141 - __main__ - INFO - Scroll attempt 1: height 4661
2025-06-05 20:28:31,146 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:28:31,147 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:28:31,262 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:28:31,384 - __main__ - INFO - Added JSON-LD event: Summerians
2025-06-05 20:28:31,486 - __main__ - INFO - Found 1 events on promoter page summerians-cova-santa
2025-06-05 20:28:31,486 - __main__ - ERROR - Error saving event 'Summerians': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:31,487 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:28:37,283 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2012/06
2025-06-05 20:28:37,283 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2012/06
2025-06-05 20:28:42,013 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/saturdays
2025-06-05 20:28:42,013 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/saturdays
2025-06-05 20:28:42,013 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/saturdays
2025-06-05 20:28:44,873 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:28:49,883 - __main__ - INFO - Scroll attempt 1: height 4553
2025-06-05 20:28:51,888 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:28:51,888 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:28:51,998 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/saturdays
2025-06-05 20:28:52,112 - __main__ - INFO - Added JSON-LD event: Saturdays Opening Party
2025-06-05 20:28:52,112 - __main__ - INFO - Added JSON-LD event: Saturdays
2025-06-05 20:28:52,252 - __main__ - INFO - Found 2 events on promoter page saturdays
2025-06-05 20:28:52,252 - __main__ - ERROR - Error saving event 'Saturdays Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:52,252 - __main__ - ERROR - Error saving event 'Saturdays': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:28:52,253 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:28:56,498 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/ibiza-anthems-ibiza-rocks
2025-06-05 20:28:56,498 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/ibiza-anthems-ibiza-rocks
2025-06-05 20:28:56,498 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/ibiza-anthems-ibiza-rocks
2025-06-05 20:28:59,016 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:29:04,026 - __main__ - INFO - Scroll attempt 1: height 5751
2025-06-05 20:29:06,032 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:29:06,032 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:29:06,179 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/ibiza-anthems-ibiza-rocks
2025-06-05 20:29:06,388 - __main__ - INFO - Added JSON-LD event: Ibiza Anthems Opening Party
2025-06-05 20:29:06,388 - __main__ - INFO - Added JSON-LD event: Ibiza Anthems Pool Party
2025-06-05 20:29:06,388 - __main__ - INFO - Added JSON-LD event: Ibiza Anthems Closing Party
2025-06-05 20:29:06,636 - __main__ - INFO - Found 3 events on promoter page ibiza-anthems-ibiza-rocks
2025-06-05 20:29:06,636 - __main__ - ERROR - Error saving event 'Ibiza Anthems Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:29:06,637 - __main__ - ERROR - Error saving event 'Ibiza Anthems Pool Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:29:06,637 - __main__ - ERROR - Error saving event 'Ibiza Anthems Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:29:06,638 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:29:11,303 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/venue/bam-bu-ku-ibiza
2025-06-05 20:29:11,304 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/venue/bam-bu-ku-ibiza
2025-06-05 20:29:11,304 - __main__ - INFO - Fetching: https://www.ibiza-spotlight.com/venue/bam-bu-ku-ibiza
2025-06-05 20:29:14,493 - __main__ - INFO - Extracted 0 promoter URLs from https://www.ibiza-spotlight.com/venue/bam-bu-ku-ibiza
2025-06-05 20:29:14,493 - __main__ - INFO - DEBUG: Found 0 promoter URLs from venue/club page 'bam-bu-ku-ibiza'
2025-06-05 20:29:14,493 - __main__ - WARNING - No promoter URLs found on venue/club page: https://www.ibiza-spotlight.com/venue/bam-bu-ku-ibiza
2025-06-05 20:29:18,998 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/05/30
2025-06-05 20:29:18,998 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/05/30
2025-06-05 20:29:22,838 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2013/06
2025-06-05 20:29:22,838 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2013/06
2025-06-05 20:29:28,102 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/you-know-vibes
2025-06-05 20:29:28,103 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/you-know-vibes
2025-06-05 20:29:28,103 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/you-know-vibes
2025-06-05 20:29:30,713 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:29:35,727 - __main__ - INFO - Scroll attempt 1: height 5914
2025-06-05 20:29:37,732 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:29:37,732 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:29:37,875 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/you-know-vibes
2025-06-05 20:29:38,110 - __main__ - INFO - Added JSON-LD event: You Know The Vibes Opening Party
2025-06-05 20:29:38,110 - __main__ - INFO - Added JSON-LD event: You Know The Vibes
2025-06-05 20:29:38,110 - __main__ - INFO - Added JSON-LD event: You Know The Vibes Closing Party
2025-06-05 20:29:38,930 - __main__ - INFO - Found 3 events on promoter page you-know-vibes
2025-06-05 20:29:38,930 - __main__ - ERROR - Error saving event 'You Know The Vibes Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:29:38,930 - __main__ - ERROR - Error saving event 'You Know The Vibes': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:29:38,931 - __main__ - ERROR - Error saving event 'You Know The Vibes Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:29:38,931 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:29:41,738 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:29:41,738 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:29:41,738 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:29:44,283 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:29:49,295 - __main__ - INFO - Scroll attempt 1: height 7623
2025-06-05 20:29:51,301 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:29:51,301 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:29:51,461 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:29:51,705 - __main__ - INFO - Added JSON-LD event: Pukka Up Afternoon Boat Party
2025-06-05 20:29:51,830 - __main__ - INFO - Found 1 events on promoter page pukka-up-saturdays
2025-06-05 20:29:51,830 - __main__ - ERROR - Error saving event 'Pukka Up Afternoon Boat Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:29:51,830 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:29:55,989 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2019/06
2025-06-05 20:29:55,989 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2019/06
2025-06-05 20:29:59,651 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:29:59,651 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:29:59,651 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:30:02,156 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:30:07,167 - __main__ - INFO - Scroll attempt 1: height 4938
2025-06-05 20:30:09,172 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:30:09,172 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:30:09,266 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:30:09,348 - __main__ - INFO - Added JSON-LD event: Seladoria
2025-06-05 20:30:09,448 - __main__ - INFO - Found 1 events on promoter page seladoria
2025-06-05 20:30:09,448 - __main__ - ERROR - Error saving event 'Seladoria': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:30:09,449 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:30:14,464 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06/01
2025-06-05 20:30:14,464 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06/01
2025-06-05 20:30:18,158 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:30:18,158 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:30:18,158 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:30:20,921 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:30:25,933 - __main__ - INFO - Scroll attempt 1: height 4747
2025-06-05 20:30:27,938 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:30:27,938 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:30:28,086 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:30:28,255 - __main__ - INFO - Added JSON-LD event: Gala by Ibn Mendoza
2025-06-05 20:30:28,363 - __main__ - INFO - Found 1 events on promoter page gala-cova-santa
2025-06-05 20:30:28,363 - __main__ - ERROR - Error saving event 'Gala by Ibn Mendoza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:30:28,364 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:30:32,232 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:30:32,233 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:30:32,233 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:30:34,647 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:30:39,659 - __main__ - INFO - Scroll attempt 1: height 5291
2025-06-05 20:30:41,665 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:30:41,665 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:30:41,804 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:30:41,969 - __main__ - INFO - Added JSON-LD event: Children of the 80s
2025-06-05 20:30:42,215 - __main__ - INFO - Found 1 events on promoter page children-80s
2025-06-05 20:30:42,216 - __main__ - ERROR - Error saving event 'Children of the 80s': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:30:42,216 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:30:45,025 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/07
2025-06-05 20:30:45,025 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/07
2025-06-05 20:30:49,723 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/kisstory-o-beach
2025-06-05 20:30:49,723 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/kisstory-o-beach
2025-06-05 20:30:49,723 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/kisstory-o-beach
2025-06-05 20:30:52,568 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:30:57,578 - __main__ - INFO - Scroll attempt 1: height 6369
2025-06-05 20:30:59,584 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:30:59,584 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:30:59,745 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/kisstory-o-beach
2025-06-05 20:30:59,983 - __main__ - INFO - Added JSON-LD event: Kisstory Opening Party
2025-06-05 20:30:59,983 - __main__ - INFO - Added JSON-LD event: Kisstory
2025-06-05 20:30:59,983 - __main__ - INFO - Added JSON-LD event: Kisstory Closing Party
2025-06-05 20:31:00,790 - __main__ - INFO - Found 3 events on promoter page kisstory-o-beach
2025-06-05 20:31:00,790 - __main__ - ERROR - Error saving event 'Kisstory Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:00,791 - __main__ - ERROR - Error saving event 'Kisstory': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:00,791 - __main__ - ERROR - Error saving event 'Kisstory Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:00,792 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:31:03,443 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2008/06
2025-06-05 20:31:03,443 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2008/06
2025-06-05 20:31:06,661 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/reboot-presents-eden
2025-06-05 20:31:06,661 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/reboot-presents-eden
2025-06-05 20:31:06,661 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/reboot-presents-eden
2025-06-05 20:31:09,697 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:31:14,708 - __main__ - INFO - Scroll attempt 1: height 6430
2025-06-05 20:31:16,713 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:31:16,713 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:31:16,868 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/reboot-presents-eden
2025-06-05 20:31:17,089 - __main__ - INFO - Added JSON-LD event: Reboot Ibiza
2025-06-05 20:31:17,089 - __main__ - INFO - Added JSON-LD event: Eden Ibiza
2025-06-05 20:31:17,089 - __main__ - INFO - Added JSON-LD event: Reboot Ibiza | Deeperfect
2025-06-05 20:31:17,089 - __main__ - INFO - Added JSON-LD event: Reboot Ibiza Closing Party
2025-06-05 20:31:17,358 - __main__ - INFO - Found 4 events on promoter page reboot-presents-eden
2025-06-05 20:31:17,358 - __main__ - ERROR - Error saving event 'Reboot Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:17,359 - __main__ - ERROR - Error saving event 'Eden Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:17,359 - __main__ - ERROR - Error saving event 'Reboot Ibiza | Deeperfect': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:17,360 - __main__ - ERROR - Error saving event 'Reboot Ibiza Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:17,360 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:31:21,229 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/05/27
2025-06-05 20:31:21,229 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/05/27
2025-06-05 20:31:26,221 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2016/06
2025-06-05 20:31:26,221 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2016/06
2025-06-05 20:31:29,667 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/do-not-sleep-amnesia
2025-06-05 20:31:29,667 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/do-not-sleep-amnesia
2025-06-05 20:31:29,667 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/do-not-sleep-amnesia
2025-06-05 20:31:32,677 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:31:37,687 - __main__ - INFO - Scroll attempt 1: height 5451
2025-06-05 20:31:39,693 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:31:39,693 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:31:39,822 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/do-not-sleep-amnesia
2025-06-05 20:31:39,988 - __main__ - INFO - Added JSON-LD event: Do Not Sleep Opening Party
2025-06-05 20:31:39,988 - __main__ - INFO - Added JSON-LD event: Do Not Sleep
2025-06-05 20:31:39,988 - __main__ - INFO - Added JSON-LD event: Do Not Sleep Closing Party
2025-06-05 20:31:40,167 - __main__ - INFO - Found 3 events on promoter page do-not-sleep-amnesia
2025-06-05 20:31:40,167 - __main__ - ERROR - Error saving event 'Do Not Sleep Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:40,167 - __main__ - ERROR - Error saving event 'Do Not Sleep': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:40,168 - __main__ - ERROR - Error saving event 'Do Not Sleep Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:40,169 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:31:44,897 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06/05
2025-06-05 20:31:44,897 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06/05
2025-06-05 20:31:49,494 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/camelphat-pacha
2025-06-05 20:31:49,494 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/camelphat-pacha
2025-06-05 20:31:49,494 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/camelphat-pacha
2025-06-05 20:31:52,233 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:31:57,243 - __main__ - INFO - Scroll attempt 1: height 6952
2025-06-05 20:31:59,249 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:31:59,249 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:31:59,420 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/camelphat-pacha
2025-06-05 20:31:59,728 - __main__ - INFO - Added JSON-LD event: CAMELPHAT Opening Party
2025-06-05 20:31:59,728 - __main__ - INFO - Added JSON-LD event: CAMELPHAT
2025-06-05 20:31:59,728 - __main__ - INFO - Added JSON-LD event: CAMELPHAT Closing Party
2025-06-05 20:31:59,984 - __main__ - INFO - Found 3 events on promoter page camelphat-pacha
2025-06-05 20:31:59,984 - __main__ - ERROR - Error saving event 'CAMELPHAT Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:59,984 - __main__ - ERROR - Error saving event 'CAMELPHAT': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:59,985 - __main__ - ERROR - Error saving event 'CAMELPHAT Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:31:59,985 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:32:02,859 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/abracadabra-pacha
2025-06-05 20:32:02,859 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/abracadabra-pacha
2025-06-05 20:32:02,859 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/abracadabra-pacha
2025-06-05 20:32:05,593 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:32:10,604 - __main__ - INFO - Scroll attempt 1: height 5702
2025-06-05 20:32:12,609 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:32:12,609 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:32:12,738 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/abracadabra-pacha
2025-06-05 20:32:12,912 - __main__ - INFO - Added JSON-LD event: Abracadabra Opening Party
2025-06-05 20:32:12,912 - __main__ - INFO - Added JSON-LD event: Abracadabra
2025-06-05 20:32:12,913 - __main__ - INFO - Added JSON-LD event: Abracadabra Closing Party
2025-06-05 20:32:13,096 - __main__ - INFO - Found 3 events on promoter page abracadabra-pacha
2025-06-05 20:32:13,096 - __main__ - ERROR - Error saving event 'Abracadabra Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:32:13,097 - __main__ - ERROR - Error saving event 'Abracadabra': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:32:13,097 - __main__ - ERROR - Error saving event 'Abracadabra Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:32:13,097 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:32:16,887 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/ibiza-rocks-pool-days
2025-06-05 20:32:16,888 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/ibiza-rocks-pool-days
2025-06-05 20:32:16,888 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/ibiza-rocks-pool-days
2025-06-05 20:32:19,444 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:32:24,455 - __main__ - INFO - Scroll attempt 1: height 5476
2025-06-05 20:32:26,460 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:32:26,460 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:32:26,609 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/ibiza-rocks-pool-days
2025-06-05 20:32:26,819 - __main__ - INFO - Added JSON-LD event: Pool Days
2025-06-05 20:32:26,819 - __main__ - INFO - Added JSON-LD event: Ibiza Rocks Pool Days
2025-06-05 20:32:26,978 - __main__ - INFO - Found 2 events on promoter page ibiza-rocks-pool-days
2025-06-05 20:32:26,979 - __main__ - ERROR - Error saving event 'Pool Days': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:32:26,979 - __main__ - ERROR - Error saving event 'Ibiza Rocks Pool Days': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:32:26,980 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:32:32,624 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/fridays-at-tipic
2025-06-05 20:32:32,624 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/fridays-at-tipic
2025-06-05 20:32:32,624 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/fridays-at-tipic
2025-06-05 20:32:35,079 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:32:40,090 - __main__ - INFO - Scroll attempt 1: height 5193
2025-06-05 20:32:42,095 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:32:42,095 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:32:42,213 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/fridays-at-tipic
2025-06-05 20:32:42,359 - __main__ - INFO - Added JSON-LD event: Calypso
2025-06-05 20:32:42,359 - __main__ - INFO - Added JSON-LD event: tipic. | Friday
2025-06-05 20:32:42,491 - __main__ - INFO - Found 2 events on promoter page fridays-at-tipic
2025-06-05 20:32:42,491 - __main__ - ERROR - Error saving event 'Calypso': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:32:42,492 - __main__ - ERROR - Error saving event 'tipic. | Friday': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:32:42,492 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:32:48,185 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=09/06/2025-15/06/2025
2025-06-05 20:32:48,185 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.com/night/events/2025/06?daterange=09/06/2025-15/06/2025
2025-06-05 20:32:51,946 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.es/night/events/2025/06
2025-06-05 20:32:51,946 - __main__ - INFO - Skipping non-target page type or already processed initial page type: https://www.ibiza-spotlight.es/night/events/2025/06
2025-06-05 20:32:55,792 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:32:55,792 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:32:55,792 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:32:58,357 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:33:03,368 - __main__ - INFO - Scroll attempt 1: height 5022
2025-06-05 20:33:05,373 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:33:05,373 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:33:05,582 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:33:05,713 - __main__ - INFO - Added JSON-LD event: MSTIZA
2025-06-05 20:33:05,903 - __main__ - INFO - Found 1 events on promoter page mestiza-hi
2025-06-05 20:33:05,903 - __main__ - ERROR - Error saving event 'MSTIZA': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:33:05,903 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:33:11,737 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:33:11,738 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:33:11,738 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:33:14,304 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:33:19,315 - __main__ - INFO - Scroll attempt 1: height 7377
2025-06-05 20:33:21,320 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:33:21,320 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:33:21,504 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:33:21,794 - __main__ - INFO - Added JSON-LD event: Glitterbox Opening Party
2025-06-05 20:33:21,794 - __main__ - INFO - Added JSON-LD event: Glitterbox
2025-06-05 20:33:21,794 - __main__ - INFO - Added JSON-LD event: Glitterbox Closing Party
2025-06-05 20:33:22,103 - __main__ - INFO - Found 3 events on promoter page hi-glitterbox
2025-06-05 20:33:22,103 - __main__ - ERROR - Error saving event 'Glitterbox Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:33:22,104 - __main__ - ERROR - Error saving event 'Glitterbox': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:33:22,104 - __main__ - ERROR - Error saving event 'Glitterbox Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:33:22,105 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:33:25,651 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/bukkle-ibiza
2025-06-05 20:33:25,651 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/bukkle-ibiza
2025-06-05 20:33:25,651 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/bukkle-ibiza
2025-06-05 20:33:28,611 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:33:33,622 - __main__ - INFO - Scroll attempt 1: height 5432
2025-06-05 20:33:35,627 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:33:35,628 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:33:35,767 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/bukkle-ibiza
2025-06-05 20:33:35,954 - __main__ - INFO - Added JSON-LD event: Bukkle Ibiza Opening Party
2025-06-05 20:33:35,955 - __main__ - INFO - Added JSON-LD event: Bukkle Ibiza
2025-06-05 20:33:35,955 - __main__ - INFO - Added JSON-LD event: Bukkle Ibiza Closing Party
2025-06-05 20:33:36,176 - __main__ - INFO - Found 3 events on promoter page bukkle-ibiza
2025-06-05 20:33:36,176 - __main__ - ERROR - Error saving event 'Bukkle Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:33:36,177 - __main__ - ERROR - Error saving event 'Bukkle Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:33:36,177 - __main__ - ERROR - Error saving event 'Bukkle Ibiza Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:33:36,178 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:33:41,096 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:33:41,096 - __main__ - INFO - Updated venue context from 'boat-parties-playa-den-bossa' to 'akasha' for URL https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:33:41,096 - __main__ - INFO - Venue/Club page detected - extracting promoter URLs from: https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:33:41,096 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:33:43,646 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:33:48,657 - __main__ - INFO - Scroll attempt 1: height 6274
2025-06-05 20:33:50,662 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:33:50,662 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/nido
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/namaste
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/supernova-las-dalias
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hernan-cattaneo-las-dalias
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/hernan-cattaneo-las-dalias
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/sven-vath-akasha
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/tales-unexpected-akasha
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/tales-unexpected-akasha
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/renaissance-akasha
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/renaissance-akasha
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/las-dalias-live-music
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/las-dalias-live-music
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/off-brand
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/off-brand
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/peace-n-music
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/peace-n-music
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/akasha-summer-weekend-parties
2025-06-05 20:33:50,825 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/akasha-summer-weekend-parties
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/akasha-winter-parties
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/akasha-winter-parties
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/seladoria
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/akasha-springtime-parties
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/akasha-springtime-parties
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/ims-akasha
2025-06-05 20:33:50,826 - __main__ - DEBUG - Found promoter URL: https://www.ibiza-spotlight.com/night/promoters/ims-akasha
2025-06-05 20:33:50,830 - __main__ - INFO - Extracted 15 promoter URLs from https://www.ibiza-spotlight.com/night/venue/akasha
2025-06-05 20:33:50,830 - __main__ - INFO - DEBUG: Found 15 promoter URLs from venue/club page 'akasha'
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/las-dalias-live-music
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/renaissance-akasha
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/peace-n-music
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/ims-akasha
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/off-brand
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/tales-unexpected-akasha
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/akasha-summer-weekend-parties
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/hernan-cattaneo-las-dalias
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/akasha-springtime-parties
2025-06-05 20:33:50,830 - __main__ - DEBUG - Added promoter URL to queue: https://www.ibiza-spotlight.com/night/promoters/akasha-winter-parties
2025-06-05 20:33:55,826 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/one-more-time-eden
2025-06-05 20:33:55,826 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/one-more-time-eden
2025-06-05 20:33:55,826 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/one-more-time-eden
2025-06-05 20:33:59,179 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:34:04,190 - __main__ - INFO - Scroll attempt 1: height 6250
2025-06-05 20:34:06,195 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:34:06,195 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:34:06,356 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/one-more-time-eden
2025-06-05 20:34:06,541 - __main__ - INFO - Added JSON-LD event: One More Time Ibiza Opening Party
2025-06-05 20:34:06,541 - __main__ - INFO - Added JSON-LD event: One More Time Ibiza
2025-06-05 20:34:06,541 - __main__ - INFO - Added JSON-LD event: One More Time Ibiza Closing Party
2025-06-05 20:34:07,625 - __main__ - INFO - Found 3 events on promoter page one-more-time-eden
2025-06-05 20:34:07,625 - __main__ - ERROR - Error saving event 'One More Time Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:07,625 - __main__ - ERROR - Error saving event 'One More Time Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:07,626 - __main__ - ERROR - Error saving event 'One More Time Ibiza Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:07,626 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:34:13,030 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/vintage-lio
2025-06-05 20:34:13,030 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/vintage-lio
2025-06-05 20:34:13,030 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/vintage-lio
2025-06-05 20:34:15,537 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:34:20,548 - __main__ - INFO - Scroll attempt 1: height 4734
2025-06-05 20:34:22,553 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:34:22,553 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:34:22,685 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/vintage-lio
2025-06-05 20:34:22,850 - __main__ - INFO - Added JSON-LD event: Vintage Opening Party
2025-06-05 20:34:22,850 - __main__ - INFO - Added JSON-LD event: Vintage
2025-06-05 20:34:23,017 - __main__ - INFO - Found 2 events on promoter page vintage-lio
2025-06-05 20:34:23,017 - __main__ - ERROR - Error saving event 'Vintage Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:23,018 - __main__ - ERROR - Error saving event 'Vintage': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:23,018 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:34:28,470 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/saturdays-tipic
2025-06-05 20:34:28,470 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/saturdays-tipic
2025-06-05 20:34:28,470 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/saturdays-tipic
2025-06-05 20:34:30,907 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:34:35,919 - __main__ - INFO - Scroll attempt 1: height 5178
2025-06-05 20:34:37,924 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:34:37,924 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:34:38,042 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/saturdays-tipic
2025-06-05 20:34:38,210 - __main__ - INFO - Added JSON-LD event: Ibiza Talents
2025-06-05 20:34:38,210 - __main__ - INFO - Added JSON-LD event: tipic. | Saturday
2025-06-05 20:34:38,364 - __main__ - INFO - Found 2 events on promoter page saturdays-tipic
2025-06-05 20:34:38,364 - __main__ - ERROR - Error saving event 'Ibiza Talents': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:38,364 - __main__ - ERROR - Error saving event 'tipic. | Saturday': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:38,365 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:34:41,470 - __main__ - INFO - Processing [1]: https://www.ibiza-spotlight.com/night/promoters/ibiza-brunch-club-classics
2025-06-05 20:34:41,471 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/ibiza-brunch-club-classics
2025-06-05 20:34:41,471 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/ibiza-brunch-club-classics
2025-06-05 20:34:43,907 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:34:48,918 - __main__ - INFO - Scroll attempt 1: height 4861
2025-06-05 20:34:50,923 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:34:50,923 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:34:51,041 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/ibiza-brunch-club-classics
2025-06-05 20:34:51,183 - __main__ - INFO - Added JSON-LD event: Ibiza Brunch Club Classics
2025-06-05 20:34:51,389 - __main__ - INFO - Found 1 events on promoter page ibiza-brunch-club-classics
2025-06-05 20:34:51,389 - __main__ - ERROR - Error saving event 'Ibiza Brunch Club Classics': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:34:51,390 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:34:55,047 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:34:55,048 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:34:55,048 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:34:58,328 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:35:03,338 - __main__ - INFO - Scroll attempt 1: height 4826
2025-06-05 20:35:05,343 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:35:05,343 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:35:05,448 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/soundgarden-cova-santa
2025-06-05 20:35:05,529 - __main__ - INFO - Added JSON-LD event: The Soundgarden
2025-06-05 20:35:05,616 - __main__ - INFO - Found 1 events on promoter page soundgarden-cova-santa
2025-06-05 20:35:05,616 - __main__ - ERROR - Error saving event 'The Soundgarden': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:35:05,617 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:35:08,704 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:35:08,705 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:35:08,705 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:35:12,573 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:35:17,583 - __main__ - INFO - Scroll attempt 1: height 6103
2025-06-05 20:35:19,589 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:35:19,590 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:35:19,774 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/piv-label-showcase
2025-06-05 20:35:19,986 - __main__ - INFO - Added JSON-LD event: PIV Ibiza Opening Party
2025-06-05 20:35:19,986 - __main__ - INFO - Added JSON-LD event: PIV Ibiza
2025-06-05 20:35:19,986 - __main__ - INFO - Added JSON-LD event: PIV Ibiza Closing Party
2025-06-05 20:35:20,231 - __main__ - INFO - Found 3 events on promoter page piv-label-showcase
2025-06-05 20:35:20,231 - __main__ - ERROR - Error saving event 'PIV Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:35:20,231 - __main__ - ERROR - Error saving event 'PIV Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:35:20,232 - __main__ - ERROR - Error saving event 'PIV Ibiza Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:35:20,232 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:35:24,370 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/gala-cova-santa
2025-06-05 20:35:24,370 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/cova-santa-presents
2025-06-05 20:35:24,371 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/cova-santa-presents
2025-06-05 20:35:24,371 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/cova-santa-presents
2025-06-05 20:35:27,742 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:35:32,752 - __main__ - INFO - Scroll attempt 1: height 4512
2025-06-05 20:35:34,757 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:35:34,757 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:35:34,855 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/cova-santa-presents
2025-06-05 20:35:34,929 - __main__ - INFO - Added JSON-LD event: K!NYXX Fetish Party
2025-06-05 20:35:35,155 - __main__ - INFO - Found 1 events on promoter page cova-santa-presents
2025-06-05 20:35:35,155 - __main__ - ERROR - Error saving event 'K!NYXX Fetish Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:35:35,156 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:35:40,214 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:35:40,214 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:35:40,214 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:35:43,417 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:35:48,428 - __main__ - INFO - Scroll attempt 1: height 4623
2025-06-05 20:35:50,433 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:35:50,434 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:35:50,554 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/masaka-cova-santa
2025-06-05 20:35:50,678 - __main__ - INFO - Added JSON-LD event: Masaka Africana
2025-06-05 20:35:50,775 - __main__ - INFO - Found 1 events on promoter page masaka-cova-santa
2025-06-05 20:35:50,775 - __main__ - ERROR - Error saving event 'Masaka Africana': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:35:50,776 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:35:56,565 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/pantheon
2025-06-05 20:35:56,565 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/fuego-silvia-superstar
2025-06-05 20:35:56,565 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/fuego-silvia-superstar
2025-06-05 20:35:56,565 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/fuego-silvia-superstar
2025-06-05 20:35:59,730 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:36:04,741 - __main__ - INFO - Scroll attempt 1: height 4237
2025-06-05 20:36:06,746 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:36:06,746 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:36:06,837 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/fuego-silvia-superstar
2025-06-05 20:36:06,910 - __main__ - INFO - Added JSON-LD event: Fuego By Silvia Superstar
2025-06-05 20:36:06,985 - __main__ - INFO - Found 1 events on promoter page fuego-silvia-superstar
2025-06-05 20:36:06,985 - __main__ - ERROR - Error saving event 'Fuego By Silvia Superstar': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:36:06,986 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:36:11,852 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/summerians-cova-santa
2025-06-05 20:36:11,852 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/utopic
2025-06-05 20:36:11,852 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/cova-santa-opening-party
2025-06-05 20:36:11,852 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/cova-santa-opening-party
2025-06-05 20:36:11,852 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/cova-santa-opening-party
2025-06-05 20:36:14,978 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:36:19,989 - __main__ - INFO - Scroll attempt 1: height 4552
2025-06-05 20:36:21,994 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:36:21,994 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:36:22,085 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/cova-santa-opening-party
2025-06-05 20:36:22,147 - __main__ - INFO - Added JSON-LD event: Cova Santa Opening Party
2025-06-05 20:36:22,233 - __main__ - INFO - Found 1 events on promoter page cova-santa-opening-party
2025-06-05 20:36:22,233 - __main__ - ERROR - Error saving event 'Cova Santa Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:36:22,234 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:36:25,102 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/eastenderz-cova-santa
2025-06-05 20:36:25,102 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/eastenderz-cova-santa
2025-06-05 20:36:25,102 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/eastenderz-cova-santa
2025-06-05 20:36:27,968 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:36:32,979 - __main__ - INFO - Scroll attempt 1: height 4767
2025-06-05 20:36:34,985 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:36:34,985 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:36:35,082 - __main__ - WARNING - No year context found for https://www.ibiza-spotlight.com/night/promoters/eastenderz-cova-santa
2025-06-05 20:36:35,157 - __main__ - INFO - Added JSON-LD event: extENDed Ibiza
2025-06-05 20:36:35,256 - __main__ - INFO - Found 1 events on promoter page eastenderz-cova-santa
2025-06-05 20:36:35,256 - __main__ - ERROR - Error saving event 'extENDed Ibiza': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:36:35,257 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:36:40,309 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/afrodise-moots
2025-06-05 20:36:40,309 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/afrodise-moots
2025-06-05 20:36:40,309 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/afrodise-moots
2025-06-05 20:36:44,017 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:36:49,027 - __main__ - INFO - Scroll attempt 1: height 4578
2025-06-05 20:36:51,033 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:36:51,033 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:36:51,153 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/afrodise-moots
2025-06-05 20:36:51,302 - __main__ - INFO - Added JSON-LD event: Afrodise &amp; Moots
2025-06-05 20:36:51,403 - __main__ - INFO - Found 1 events on promoter page afrodise-moots
2025-06-05 20:36:51,403 - __main__ - ERROR - Error saving event 'Afrodise &amp; Moots': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:36:51,404 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:36:57,385 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/woomoon
2025-06-05 20:36:57,385 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/cosmic-pineapple
2025-06-05 20:36:57,386 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/cosmic-pineapple
2025-06-05 20:36:57,386 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/cosmic-pineapple
2025-06-05 20:37:00,529 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:37:05,540 - __main__ - INFO - Scroll attempt 1: height 4950
2025-06-05 20:37:07,545 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:37:07,545 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:37:07,642 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/cosmic-pineapple
2025-06-05 20:37:07,723 - __main__ - INFO - Added JSON-LD event: Cosmic Pineapple | 10th Anniversary
2025-06-05 20:37:07,819 - __main__ - INFO - Found 1 events on promoter page cosmic-pineapple
2025-06-05 20:37:07,819 - __main__ - ERROR - Error saving event 'Cosmic Pineapple | 10th Anniversary': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:07,820 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:37:12,066 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/pukka-up-saturdays
2025-06-05 20:37:12,066 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/day-paradise
2025-06-05 20:37:12,066 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/float-your-boat-sunset-experience
2025-06-05 20:37:12,066 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/pukka_up_i.htm
2025-06-05 20:37:12,066 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/anotr-unvrs
2025-06-05 20:37:12,066 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/anotr-unvrs
2025-06-05 20:37:12,066 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/anotr-unvrs
2025-06-05 20:37:14,776 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:37:19,787 - __main__ - INFO - Scroll attempt 1: height 4530
2025-06-05 20:37:21,792 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:37:21,792 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:37:21,892 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/anotr-unvrs
2025-06-05 20:37:21,958 - __main__ - INFO - Added JSON-LD event: ANOTR On A Trip
2025-06-05 20:37:22,139 - __main__ - INFO - Found 1 events on promoter page anotr-unvrs
2025-06-05 20:37:22,139 - __main__ - ERROR - Error saving event 'ANOTR On A Trip': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:22,140 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:37:24,656 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/paradise-unvrs
2025-06-05 20:37:24,657 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/paradise-unvrs
2025-06-05 20:37:24,657 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/paradise-unvrs
2025-06-05 20:37:27,042 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:37:32,053 - __main__ - INFO - Scroll attempt 1: height 6407
2025-06-05 20:37:34,058 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:37:34,058 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:37:34,200 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/paradise-unvrs
2025-06-05 20:37:34,415 - __main__ - INFO - Added JSON-LD event: Paradise Opening Party
2025-06-05 20:37:34,415 - __main__ - INFO - Added JSON-LD event: Paradise
2025-06-05 20:37:34,415 - __main__ - INFO - Added JSON-LD event: Paradise Closing Party
2025-06-05 20:37:34,661 - __main__ - INFO - Found 3 events on promoter page paradise-unvrs
2025-06-05 20:37:34,661 - __main__ - ERROR - Error saving event 'Paradise Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:34,662 - __main__ - ERROR - Error saving event 'Paradise': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:34,662 - __main__ - ERROR - Error saving event 'Paradise Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:34,663 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:37:39,578 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/unvrs-opening-party
2025-06-05 20:37:39,578 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/eric-prydz-unvrs
2025-06-05 20:37:39,578 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/eric-prydz-unvrs
2025-06-05 20:37:39,578 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/eric-prydz-unvrs
2025-06-05 20:37:42,685 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:37:47,695 - __main__ - INFO - Scroll attempt 1: height 6104
2025-06-05 20:37:49,700 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:37:49,701 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:37:49,828 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/eric-prydz-unvrs
2025-06-05 20:37:50,014 - __main__ - INFO - Added JSON-LD event: Eric Prydz presents Holosphere 2.0 Opening Party
2025-06-05 20:37:50,014 - __main__ - INFO - Added JSON-LD event: Eric Prydz presents Holosphere 2.0
2025-06-05 20:37:50,015 - __main__ - INFO - Added JSON-LD event: Eric Prydz presents Holosphere 2.0 Closing Party
2025-06-05 20:37:50,192 - __main__ - INFO - Found 3 events on promoter page eric-prydz-unvrs
2025-06-05 20:37:50,192 - __main__ - ERROR - Error saving event 'Eric Prydz presents Holosphere 2.0 Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:50,193 - __main__ - ERROR - Error saving event 'Eric Prydz presents Holosphere 2.0': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:50,193 - __main__ - ERROR - Error saving event 'Eric Prydz presents Holosphere 2.0 Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:37:50,194 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:37:54,462 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/anyma-unvrs
2025-06-05 20:37:54,462 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/anyma-unvrs
2025-06-05 20:37:54,462 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/anyma-unvrs
2025-06-05 20:37:56,941 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:38:01,951 - __main__ - INFO - Scroll attempt 1: height 4978
2025-06-05 20:38:03,957 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:38:03,957 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:38:04,068 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/anyma-unvrs
2025-06-05 20:38:04,187 - __main__ - INFO - Added JSON-LD event: Anyma Opening Party
2025-06-05 20:38:04,187 - __main__ - INFO - Added JSON-LD event: Anyma
2025-06-05 20:38:04,187 - __main__ - INFO - Added JSON-LD event: Anyma Closing Party
2025-06-05 20:38:04,342 - __main__ - INFO - Found 3 events on promoter page anyma-unvrs
2025-06-05 20:38:04,342 - __main__ - ERROR - Error saving event 'Anyma Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:04,343 - __main__ - ERROR - Error saving event 'Anyma': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:04,343 - __main__ - ERROR - Error saving event 'Anyma Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:04,344 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:38:09,711 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/carl-cox
2025-06-05 20:38:09,711 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/carl-cox
2025-06-05 20:38:09,711 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/carl-cox
2025-06-05 20:38:12,312 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:38:17,323 - __main__ - INFO - Scroll attempt 1: height 6340
2025-06-05 20:38:19,328 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:38:19,329 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:38:19,525 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/carl-cox
2025-06-05 20:38:19,733 - __main__ - INFO - Added JSON-LD event: Carl Cox Opening Party
2025-06-05 20:38:19,733 - __main__ - INFO - Added JSON-LD event: Carl Cox
2025-06-05 20:38:19,733 - __main__ - INFO - Added JSON-LD event: Carl Cox Closing Party
2025-06-05 20:38:19,938 - __main__ - INFO - Found 3 events on promoter page carl-cox
2025-06-05 20:38:19,938 - __main__ - ERROR - Error saving event 'Carl Cox Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:19,939 - __main__ - ERROR - Error saving event 'Carl Cox': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:19,939 - __main__ - ERROR - Error saving event 'Carl Cox Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:19,940 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:38:25,298 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/david-guetta-unvrs
2025-06-05 20:38:25,298 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/david-guetta-unvrs
2025-06-05 20:38:25,299 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/david-guetta-unvrs
2025-06-05 20:38:28,336 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:38:33,347 - __main__ - INFO - Scroll attempt 1: height 5936
2025-06-05 20:38:35,352 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:38:35,353 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:38:35,491 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/david-guetta-unvrs
2025-06-05 20:38:35,686 - __main__ - INFO - Added JSON-LD event: David Guetta presents Galactic Circus Opening Party
2025-06-05 20:38:35,687 - __main__ - INFO - Added JSON-LD event: David Guetta presents Galactic Circus
2025-06-05 20:38:35,687 - __main__ - INFO - Added JSON-LD event: David Guetta presents Galactic Circus Closing Party
2025-06-05 20:38:36,860 - __main__ - INFO - Found 3 events on promoter page david-guetta-unvrs
2025-06-05 20:38:36,860 - __main__ - ERROR - Error saving event 'David Guetta presents Galactic Circus Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:36,861 - __main__ - ERROR - Error saving event 'David Guetta presents Galactic Circus': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:36,861 - __main__ - ERROR - Error saving event 'David Guetta presents Galactic Circus Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:36,862 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:38:40,221 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/sara-landry-unvrs
2025-06-05 20:38:40,221 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/sara-landry-unvrs
2025-06-05 20:38:40,221 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/sara-landry-unvrs
2025-06-05 20:38:42,721 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:38:47,732 - __main__ - INFO - Scroll attempt 1: height 4233
2025-06-05 20:38:49,738 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:38:49,738 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:38:49,822 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/sara-landry-unvrs
2025-06-05 20:38:49,889 - __main__ - INFO - Added JSON-LD event: Sara Landry presents Eternalism
2025-06-05 20:38:50,065 - __main__ - INFO - Found 1 events on promoter page sara-landry-unvrs
2025-06-05 20:38:50,066 - __main__ - ERROR - Error saving event 'Sara Landry presents Eternalism': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:38:50,066 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:38:52,602 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/fisher-unvrs
2025-06-05 20:38:52,602 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/fisher-unvrs
2025-06-05 20:38:52,602 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/fisher-unvrs
2025-06-05 20:38:55,287 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:39:00,298 - __main__ - INFO - Scroll attempt 1: height 6395
2025-06-05 20:39:02,304 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:39:02,304 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:39:02,465 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/fisher-unvrs
2025-06-05 20:39:02,655 - __main__ - INFO - Added JSON-LD event: FISHER Opening Party
2025-06-05 20:39:02,655 - __main__ - INFO - Added JSON-LD event: FISHER
2025-06-05 20:39:02,655 - __main__ - INFO - Added JSON-LD event: FISHER Closing Party
2025-06-05 20:39:02,854 - __main__ - INFO - Found 3 events on promoter page fisher-unvrs
2025-06-05 20:39:02,854 - __main__ - ERROR - Error saving event 'FISHER Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:02,855 - __main__ - ERROR - Error saving event 'FISHER': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:02,855 - __main__ - ERROR - Error saving event 'FISHER Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:02,856 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:39:08,473 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/elrow-unvrs
2025-06-05 20:39:08,473 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/elrow-unvrs
2025-06-05 20:39:08,474 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/elrow-unvrs
2025-06-05 20:39:10,941 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:39:15,952 - __main__ - INFO - Scroll attempt 1: height 6304
2025-06-05 20:39:17,957 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:39:17,957 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:39:18,107 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/elrow-unvrs
2025-06-05 20:39:18,326 - __main__ - INFO - Added JSON-LD event: elrow Ibiza Opening Party | Nowmads New World
2025-06-05 20:39:18,326 - __main__ - INFO - Added JSON-LD event: elrow Ibiza | Nowmads New World
2025-06-05 20:39:18,326 - __main__ - INFO - Added JSON-LD event: elrow Ibiza | Hallucinarium
2025-06-05 20:39:18,326 - __main__ - INFO - Added JSON-LD event: elrow Ibiza | Neo Kaos Garden
2025-06-05 20:39:18,326 - __main__ - INFO - Added JSON-LD event: elrow Ibiza | BBC Radio 1 Dance X
2025-06-05 20:39:18,326 - __main__ - INFO - Added JSON-LD event: elrow Ibiza Closing Party | New Theme TBA
2025-06-05 20:39:18,670 - __main__ - INFO - Found 6 events on promoter page elrow-unvrs
2025-06-05 20:39:18,670 - __main__ - ERROR - Error saving event 'elrow Ibiza Opening Party | Nowmads New World': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:18,671 - __main__ - ERROR - Error saving event 'elrow Ibiza | Nowmads New World': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:18,672 - __main__ - ERROR - Error saving event 'elrow Ibiza | Hallucinarium': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:18,672 - __main__ - ERROR - Error saving event 'elrow Ibiza | Neo Kaos Garden': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:18,673 - __main__ - ERROR - Error saving event 'elrow Ibiza | BBC Radio 1 Dance X': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:18,673 - __main__ - ERROR - Error saving event 'elrow Ibiza Closing Party | New Theme TBA': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:18,674 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:39:21,945 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/children-80s
2025-06-05 20:39:21,945 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/rumors-playa-soleil
2025-06-05 20:39:21,946 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/rumors-playa-soleil
2025-06-05 20:39:21,946 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/rumors-playa-soleil
2025-06-05 20:39:24,470 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:39:29,481 - __main__ - INFO - Scroll attempt 1: height 4868
2025-06-05 20:39:31,485 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:39:31,485 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:39:31,603 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/rumors-playa-soleil
2025-06-05 20:39:31,736 - __main__ - INFO - Added JSON-LD event: RUMORS
2025-06-05 20:39:31,840 - __main__ - INFO - Found 1 events on promoter page rumors-playa-soleil
2025-06-05 20:39:31,840 - __main__ - ERROR - Error saving event 'RUMORS': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:31,840 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:39:37,728 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/bazar-playa-soleil
2025-06-05 20:39:37,729 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/bazar-playa-soleil
2025-06-05 20:39:37,729 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/bazar-playa-soleil
2025-06-05 20:39:40,644 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:39:45,655 - __main__ - INFO - Scroll attempt 1: height 4514
2025-06-05 20:39:47,660 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:39:47,660 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:39:47,773 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/bazar-playa-soleil
2025-06-05 20:39:47,913 - __main__ - INFO - Added JSON-LD event: Bzr by Sasson
2025-06-05 20:39:48,022 - __main__ - INFO - Found 1 events on promoter page bazar-playa-soleil
2025-06-05 20:39:48,022 - __main__ - ERROR - Error saving event 'Bzr by Sasson': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:39:48,023 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:39:52,005 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/la-troya-playa-soleil
2025-06-05 20:39:52,006 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/la-troya-playa-soleil
2025-06-05 20:39:52,006 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/la-troya-playa-soleil
2025-06-05 20:39:55,211 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:40:00,222 - __main__ - INFO - Scroll attempt 1: height 5012
2025-06-05 20:40:02,227 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:40:02,227 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:40:02,342 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/la-troya-playa-soleil
2025-06-05 20:40:02,487 - __main__ - INFO - Added JSON-LD event: La Troya Opening Party
2025-06-05 20:40:02,487 - __main__ - INFO - Added JSON-LD event: La Troya
2025-06-05 20:40:02,487 - __main__ - INFO - Added JSON-LD event: La Troya Closing Party
2025-06-05 20:40:03,019 - __main__ - INFO - Found 3 events on promoter page la-troya-playa-soleil
2025-06-05 20:40:03,020 - __main__ - ERROR - Error saving event 'La Troya Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:03,020 - __main__ - ERROR - Error saving event 'La Troya': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:03,020 - __main__ - ERROR - Error saving event 'La Troya Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:03,021 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:40:06,563 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/saga-chinois
2025-06-05 20:40:06,563 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/saga-chinois
2025-06-05 20:40:06,563 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/saga-chinois
2025-06-05 20:40:09,298 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:40:14,310 - __main__ - INFO - Scroll attempt 1: height 5775
2025-06-05 20:40:16,315 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:40:16,315 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:40:16,459 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/saga-chinois
2025-06-05 20:40:16,665 - __main__ - INFO - Added JSON-LD event: Bedouin present Saga Opening Party
2025-06-05 20:40:16,665 - __main__ - INFO - Added JSON-LD event: Bedouin present Saga
2025-06-05 20:40:16,665 - __main__ - INFO - Added JSON-LD event: Bedouin present Saga Closing Party
2025-06-05 20:40:18,910 - __main__ - INFO - Found 3 events on promoter page saga-chinois
2025-06-05 20:40:18,910 - __main__ - ERROR - Error saving event 'Bedouin present Saga Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:18,911 - __main__ - ERROR - Error saving event 'Bedouin present Saga': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:18,911 - __main__ - ERROR - Error saving event 'Bedouin present Saga Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:18,912 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:40:23,699 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/trip-club-chinois
2025-06-05 20:40:23,699 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/trip-club-chinois
2025-06-05 20:40:23,700 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/trip-club-chinois
2025-06-05 20:40:26,819 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:40:31,830 - __main__ - INFO - Scroll attempt 1: height 6515
2025-06-05 20:40:33,836 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:40:33,836 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:40:33,993 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/trip-club-chinois
2025-06-05 20:40:34,286 - __main__ - INFO - Added JSON-LD event: TRIP
2025-06-05 20:40:34,287 - __main__ - INFO - Added JSON-LD event: TRIP | Easter Special
2025-06-05 20:40:34,287 - __main__ - INFO - Added JSON-LD event: TRIP | Collisions
2025-06-05 20:40:34,287 - __main__ - INFO - Added JSON-LD event: TRIP | get-traum
2025-06-05 20:40:34,287 - __main__ - INFO - Added JSON-LD event: TRIP Opening Party
2025-06-05 20:40:34,287 - __main__ - INFO - Added JSON-LD event: TRIP | Limousine Dream
2025-06-05 20:40:34,287 - __main__ - INFO - Added JSON-LD event: TRIP | Yokaku
2025-06-05 20:40:34,287 - __main__ - INFO - Added JSON-LD event: TRIP Closing Party
2025-06-05 20:40:34,772 - __main__ - INFO - Found 8 events on promoter page trip-club-chinois
2025-06-05 20:40:34,772 - __main__ - ERROR - Error saving event 'TRIP': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,773 - __main__ - ERROR - Error saving event 'TRIP | Easter Special': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,773 - __main__ - ERROR - Error saving event 'TRIP | Collisions': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,774 - __main__ - ERROR - Error saving event 'TRIP | get-traum': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,774 - __main__ - ERROR - Error saving event 'TRIP Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,774 - __main__ - ERROR - Error saving event 'TRIP | Limousine Dream': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,775 - __main__ - ERROR - Error saving event 'TRIP | Yokaku': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,775 - __main__ - ERROR - Error saving event 'TRIP Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:34,776 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:40:38,659 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/ims-dalt-vila-afterparty
2025-06-05 20:40:38,659 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/ims-dalt-vila-afterparty
2025-06-05 20:40:38,659 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/ims-dalt-vila-afterparty
2025-06-05 20:40:41,219 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:40:46,229 - __main__ - INFO - Scroll attempt 1: height 4969
2025-06-05 20:40:48,234 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:40:48,234 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:40:48,329 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/ims-dalt-vila-afterparty
2025-06-05 20:40:48,400 - __main__ - INFO - Added JSON-LD event: Official IMS Grand Finale After Party
2025-06-05 20:40:48,601 - __main__ - INFO - Found 1 events on promoter page ims-dalt-vila-afterparty
2025-06-05 20:40:48,601 - __main__ - ERROR - Error saving event 'Official IMS Grand Finale After Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:40:48,602 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:40:53,319 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/honey-dijon-chinois
2025-06-05 20:40:53,319 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/honey-dijon-chinois
2025-06-05 20:40:53,319 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/honey-dijon-chinois
2025-06-05 20:40:55,844 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:41:00,854 - __main__ - INFO - Scroll attempt 1: height 5248
2025-06-05 20:41:02,859 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:41:02,859 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:41:02,975 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/honey-dijon-chinois
2025-06-05 20:41:03,142 - __main__ - INFO - Added JSON-LD event: Honey F#cking Dijon Opening Party
2025-06-05 20:41:03,142 - __main__ - INFO - Added JSON-LD event: Honey F#cking Dijon
2025-06-05 20:41:03,142 - __main__ - INFO - Added JSON-LD event: Honey F#cking Dijon Closing Party
2025-06-05 20:41:03,975 - __main__ - INFO - Found 3 events on promoter page honey-dijon-chinois
2025-06-05 20:41:03,976 - __main__ - ERROR - Error saving event 'Honey F#cking Dijon Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:03,976 - __main__ - ERROR - Error saving event 'Honey F#cking Dijon': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:03,976 - __main__ - ERROR - Error saving event 'Honey F#cking Dijon Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:03,977 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:41:07,463 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/shimza-chinois
2025-06-05 20:41:07,463 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/shimza-chinois
2025-06-05 20:41:07,463 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/shimza-chinois
2025-06-05 20:41:10,002 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:41:15,020 - __main__ - INFO - Scroll attempt 1: height 4349
2025-06-05 20:41:17,025 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:41:17,025 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:41:17,130 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/shimza-chinois
2025-06-05 20:41:17,227 - __main__ - INFO - Added JSON-LD event: Shimza &amp; Co.
2025-06-05 20:41:17,411 - __main__ - INFO - Found 1 events on promoter page shimza-chinois
2025-06-05 20:41:17,411 - __main__ - ERROR - Error saving event 'Shimza &amp; Co.': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:17,412 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:41:23,294 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/chinois-ibiza-pre-season-parties
2025-06-05 20:41:23,294 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/chinois-ibiza-pre-season-parties
2025-06-05 20:41:23,294 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/chinois-ibiza-pre-season-parties
2025-06-05 20:41:25,921 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:41:30,932 - __main__ - INFO - Scroll attempt 1: height 5550
2025-06-05 20:41:32,937 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:41:32,937 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:41:33,036 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/chinois-ibiza-pre-season-parties
2025-06-05 20:41:33,124 - __main__ - INFO - Added JSON-LD event: Chinois presents Darius Syrossian
2025-06-05 20:41:33,124 - __main__ - INFO - Added JSON-LD event: Chinois Presents
2025-06-05 20:41:33,124 - __main__ - INFO - Added JSON-LD event: BOHO Goes Beyond
2025-06-05 20:41:33,124 - __main__ - INFO - Added JSON-LD event: Chinois presents Max Dean
2025-06-05 20:41:34,755 - __main__ - INFO - Found 4 events on promoter page chinois-ibiza-pre-season-parties
2025-06-05 20:41:34,755 - __main__ - ERROR - Error saving event 'Chinois presents Darius Syrossian': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:34,756 - __main__ - ERROR - Error saving event 'Chinois Presents': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:34,756 - __main__ - ERROR - Error saving event 'BOHO Goes Beyond': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:34,757 - __main__ - ERROR - Error saving event 'Chinois presents Max Dean': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:34,757 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:41:39,213 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/francis-mercier-chinois
2025-06-05 20:41:39,213 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/francis-mercier-chinois
2025-06-05 20:41:39,213 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/francis-mercier-chinois
2025-06-05 20:41:42,032 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:41:47,043 - __main__ - INFO - Scroll attempt 1: height 5341
2025-06-05 20:41:49,049 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:41:49,049 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:41:49,169 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/francis-mercier-chinois
2025-06-05 20:41:49,312 - __main__ - INFO - Added JSON-LD event: Francis Mercier presents Soly Opening Party
2025-06-05 20:41:49,312 - __main__ - INFO - Added JSON-LD event: Francis Mercier presents Soly
2025-06-05 20:41:49,312 - __main__ - INFO - Added JSON-LD event: Francis Mercier presents Soly Closing Party
2025-06-05 20:41:49,830 - __main__ - INFO - Found 3 events on promoter page francis-mercier-chinois
2025-06-05 20:41:49,830 - __main__ - ERROR - Error saving event 'Francis Mercier presents Soly Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:49,831 - __main__ - ERROR - Error saving event 'Francis Mercier presents Soly': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:49,831 - __main__ - ERROR - Error saving event 'Francis Mercier presents Soly Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:41:49,832 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:41:54,865 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/masquerade-chinois
2025-06-05 20:41:54,865 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/sondela-chinois
2025-06-05 20:41:54,866 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/sondela-chinois
2025-06-05 20:41:54,866 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/sondela-chinois
2025-06-05 20:41:57,465 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:42:02,475 - __main__ - INFO - Scroll attempt 1: height 5087
2025-06-05 20:42:04,480 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:42:04,480 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:42:04,595 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/sondela-chinois
2025-06-05 20:42:04,686 - __main__ - INFO - Added JSON-LD event: Sondela
2025-06-05 20:42:04,842 - __main__ - INFO - Found 1 events on promoter page sondela-chinois
2025-06-05 20:42:04,842 - __main__ - ERROR - Error saving event 'Sondela': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:04,843 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:42:07,852 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/chinois-presents
2025-06-05 20:42:07,852 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/club-chinois-opening-party
2025-06-05 20:42:07,852 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/club-chinois-opening-party
2025-06-05 20:42:07,852 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/club-chinois-opening-party
2025-06-05 20:42:10,802 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:42:15,813 - __main__ - INFO - Scroll attempt 1: height 4673
2025-06-05 20:42:17,818 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:42:17,818 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:42:17,919 - __main__ - WARNING - No year context found for https://www.ibiza-spotlight.com/night/promoters/club-chinois-opening-party
2025-06-05 20:42:17,996 - __main__ - INFO - Added JSON-LD event: Chinois Grand Opening Party
2025-06-05 20:42:18,141 - __main__ - INFO - Found 1 events on promoter page club-chinois-opening-party
2025-06-05 20:42:18,142 - __main__ - ERROR - Error saving event 'Chinois Grand Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:18,142 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:42:21,826 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/kerri-chandler-chinois
2025-06-05 20:42:21,826 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/kerri-chandler-chinois
2025-06-05 20:42:21,827 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/kerri-chandler-chinois
2025-06-05 20:42:24,417 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:42:29,428 - __main__ - INFO - Scroll attempt 1: height 5766
2025-06-05 20:42:31,433 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:42:31,433 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:42:31,562 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/kerri-chandler-chinois
2025-06-05 20:42:31,741 - __main__ - INFO - Added JSON-LD event: Kerri Chandler presents Kaoz Theory Opening Party
2025-06-05 20:42:31,741 - __main__ - INFO - Added JSON-LD event: Kerri Chandler presents Kaoz Theory
2025-06-05 20:42:31,741 - __main__ - INFO - Added JSON-LD event: Kerri Chandler presents Kaoz Theory Closing Party
2025-06-05 20:42:33,632 - __main__ - INFO - Found 3 events on promoter page kerri-chandler-chinois
2025-06-05 20:42:33,632 - __main__ - ERROR - Error saving event 'Kerri Chandler presents Kaoz Theory Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:33,633 - __main__ - ERROR - Error saving event 'Kerri Chandler presents Kaoz Theory': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:33,633 - __main__ - ERROR - Error saving event 'Kerri Chandler presents Kaoz Theory Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:33,634 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:42:37,172 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/martinez-brothers
2025-06-05 20:42:37,173 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/martinez-brothers
2025-06-05 20:42:37,173 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/martinez-brothers
2025-06-05 20:42:39,665 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:42:44,677 - __main__ - INFO - Scroll attempt 1: height 6932
2025-06-05 20:42:46,682 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:42:46,683 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:42:46,834 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/martinez-brothers
2025-06-05 20:42:47,065 - __main__ - INFO - Added JSON-LD event: The Martinez Brothers Opening Party
2025-06-05 20:42:47,065 - __main__ - INFO - Added JSON-LD event: The Martinez Brothers
2025-06-05 20:42:47,065 - __main__ - INFO - Added JSON-LD event: The Martinez Brothers Closing party
2025-06-05 20:42:48,862 - __main__ - INFO - Found 3 events on promoter page martinez-brothers
2025-06-05 20:42:48,862 - __main__ - ERROR - Error saving event 'The Martinez Brothers Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:48,862 - __main__ - ERROR - Error saving event 'The Martinez Brothers': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:48,863 - __main__ - ERROR - Error saving event 'The Martinez Brothers Closing party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:42:48,863 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:42:52,586 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/blackworks-hi
2025-06-05 20:42:52,586 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/blackworks-hi
2025-06-05 20:42:52,587 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/blackworks-hi
2025-06-05 20:42:55,133 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:43:00,144 - __main__ - INFO - Scroll attempt 1: height 5362
2025-06-05 20:43:02,149 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:43:02,149 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:43:02,267 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/blackworks-hi
2025-06-05 20:43:02,401 - __main__ - INFO - Added JSON-LD event: Blackworks
2025-06-05 20:43:02,788 - __main__ - INFO - Found 1 events on promoter page blackworks-hi
2025-06-05 20:43:02,788 - __main__ - ERROR - Error saving event 'Blackworks': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:43:02,789 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:43:06,618 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/paco-osuna-presents-now-here
2025-06-05 20:43:06,618 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/paco-osuna-presents-now-here
2025-06-05 20:43:06,618 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/paco-osuna-presents-now-here
2025-06-05 20:43:09,127 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:43:14,138 - __main__ - INFO - Scroll attempt 1: height 5170
2025-06-05 20:43:16,142 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:43:16,142 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:43:16,332 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/paco-osuna-presents-now-here
2025-06-05 20:43:16,410 - __main__ - INFO - Added JSON-LD event: Paco Osuna presents Now Here
2025-06-05 20:43:16,745 - __main__ - INFO - Found 1 events on promoter page paco-osuna-presents-now-here
2025-06-05 20:43:16,745 - __main__ - ERROR - Error saving event 'Paco Osuna presents Now Here': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:43:16,745 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:43:21,245 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/hi-glitterbox
2025-06-05 20:43:21,245 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/glitterbox-special
2025-06-05 20:43:21,245 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/glitterbox-special
2025-06-05 20:43:21,246 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/glitterbox-special
2025-06-05 20:43:23,784 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:43:28,795 - __main__ - INFO - Scroll attempt 1: height 4917
2025-06-05 20:43:30,801 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:43:30,801 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:43:30,898 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/glitterbox-special
2025-06-05 20:43:30,970 - __main__ - INFO - Added JSON-LD event: Glitterbox | BBC Radio 1 Dance X
2025-06-05 20:43:31,047 - __main__ - INFO - Found 1 events on promoter page glitterbox-special
2025-06-05 20:43:31,047 - __main__ - ERROR - Error saving event 'Glitterbox | BBC Radio 1 Dance X': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:43:31,048 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:43:36,104 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/hi-ibiza-opening-party-2025
2025-06-05 20:43:36,104 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/hi-ibiza-opening-party-2025
2025-06-05 20:43:36,104 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/hi-ibiza-opening-party-2025
2025-06-05 20:43:38,609 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:43:43,620 - __main__ - INFO - Scroll attempt 1: height 5554
2025-06-05 20:43:45,625 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:43:45,625 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:43:45,744 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/hi-ibiza-opening-party-2025
2025-06-05 20:43:45,835 - __main__ - INFO - Added JSON-LD event: H Ibiza Opening Party
2025-06-05 20:43:45,946 - __main__ - INFO - Found 1 events on promoter page hi-ibiza-opening-party-2025
2025-06-05 20:43:45,946 - __main__ - ERROR - Error saving event 'H Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:43:45,947 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:43:50,315 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/our-house-hi-ibiza
2025-06-05 20:43:50,315 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/our-house-hi-ibiza
2025-06-05 20:43:50,315 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/our-house-hi-ibiza
2025-06-05 20:43:52,894 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:43:57,903 - __main__ - INFO - Scroll attempt 1: height 7001
2025-06-05 20:43:59,909 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:43:59,909 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:44:00,065 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/our-house-hi-ibiza
2025-06-05 20:44:00,328 - __main__ - INFO - Added JSON-LD event: Meduza &amp; James Hype present Our House Opening Party
2025-06-05 20:44:00,328 - __main__ - INFO - Added JSON-LD event: Meduza &amp; James Hype present Our House
2025-06-05 20:44:00,328 - __main__ - INFO - Added JSON-LD event: Meduza &amp; James Hype present Our House Closing Party
2025-06-05 20:44:02,442 - __main__ - INFO - Found 3 events on promoter page our-house-hi-ibiza
2025-06-05 20:44:02,442 - __main__ - ERROR - Error saving event 'Meduza &amp; James Hype present Our House Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:02,442 - __main__ - ERROR - Error saving event 'Meduza &amp; James Hype present Our House': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:02,443 - __main__ - ERROR - Error saving event 'Meduza &amp; James Hype present Our House Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:02,443 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:44:07,453 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/john-summit-hi
2025-06-05 20:44:07,454 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/john-summit-hi
2025-06-05 20:44:07,454 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/john-summit-hi
2025-06-05 20:44:09,951 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:44:14,962 - __main__ - INFO - Scroll attempt 1: height 4483
2025-06-05 20:44:16,968 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:44:16,968 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:44:17,065 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/john-summit-hi
2025-06-05 20:44:17,151 - __main__ - INFO - Added JSON-LD event: John Summit presents Experts Only
2025-06-05 20:44:17,380 - __main__ - INFO - Found 1 events on promoter page john-summit-hi
2025-06-05 20:44:17,380 - __main__ - ERROR - Error saving event 'John Summit presents Experts Only': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:17,381 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:44:20,885 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/hugel-hi
2025-06-05 20:44:20,886 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/hugel-hi
2025-06-05 20:44:20,886 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/hugel-hi
2025-06-05 20:44:24,804 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:44:29,814 - __main__ - INFO - Scroll attempt 1: height 5984
2025-06-05 20:44:31,820 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:44:31,820 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:44:31,976 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/hugel-hi
2025-06-05 20:44:32,150 - __main__ - INFO - Added JSON-LD event: HUGEL presents Make The Girls Dance Opening Party
2025-06-05 20:44:32,151 - __main__ - INFO - Added JSON-LD event: HUGEL presents Make The Girls Dance
2025-06-05 20:44:32,151 - __main__ - INFO - Added JSON-LD event: HUGEL presents Make The Girls Dance Closing Party
2025-06-05 20:44:33,633 - __main__ - INFO - Found 3 events on promoter page hugel-hi
2025-06-05 20:44:33,633 - __main__ - ERROR - Error saving event 'HUGEL presents Make The Girls Dance Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:33,634 - __main__ - ERROR - Error saving event 'HUGEL presents Make The Girls Dance': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:33,634 - __main__ - ERROR - Error saving event 'HUGEL presents Make The Girls Dance Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:33,635 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:44:37,347 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/metamorfosi-hi
2025-06-05 20:44:37,347 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/metamorfosi-hi
2025-06-05 20:44:37,347 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/metamorfosi-hi
2025-06-05 20:44:40,372 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:44:45,383 - __main__ - INFO - Scroll attempt 1: height 6952
2025-06-05 20:44:47,389 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:44:47,389 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:44:47,551 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/metamorfosi-hi
2025-06-05 20:44:47,779 - __main__ - INFO - Added JSON-LD event: Joseph Capriati presents Metamorfosi Opening Party
2025-06-05 20:44:47,779 - __main__ - INFO - Added JSON-LD event: Joseph Capriati presents Metamorfosi
2025-06-05 20:44:47,779 - __main__ - INFO - Added JSON-LD event: Joseph Capriati presents Metamorfosi Closing Party
2025-06-05 20:44:49,461 - __main__ - INFO - Found 3 events on promoter page metamorfosi-hi
2025-06-05 20:44:49,462 - __main__ - ERROR - Error saving event 'Joseph Capriati presents Metamorfosi Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:49,462 - __main__ - ERROR - Error saving event 'Joseph Capriati presents Metamorfosi': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:49,463 - __main__ - ERROR - Error saving event 'Joseph Capriati presents Metamorfosi Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:44:49,463 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:44:53,789 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/dom-dolla
2025-06-05 20:44:53,789 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/dom-dolla
2025-06-05 20:44:53,789 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/dom-dolla
2025-06-05 20:44:56,271 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:45:01,283 - __main__ - INFO - Scroll attempt 1: height 4869
2025-06-05 20:45:03,288 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:45:03,288 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:45:03,425 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/dom-dolla
2025-06-05 20:45:03,567 - __main__ - INFO - Added JSON-LD event: Dom Dolla Opening Party
2025-06-05 20:45:03,567 - __main__ - INFO - Added JSON-LD event: Dom Dolla
2025-06-05 20:45:03,567 - __main__ - INFO - Added JSON-LD event: Dom Dolla Closing Party
2025-06-05 20:45:03,731 - __main__ - INFO - Found 3 events on promoter page dom-dolla
2025-06-05 20:45:03,731 - __main__ - ERROR - Error saving event 'Dom Dolla Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:03,732 - __main__ - ERROR - Error saving event 'Dom Dolla': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:03,732 - __main__ - ERROR - Error saving event 'Dom Dolla Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:03,733 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:45:08,465 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/mestiza-hi
2025-06-05 20:45:08,465 - __main__ - DEBUG - Skipping already visited URL: https://www.ibiza-spotlight.com/night/promoters/oceanbeat-ibiza-boat-party
2025-06-05 20:45:08,466 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/las-dalias-live-music
2025-06-05 20:45:08,466 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/las-dalias-live-music
2025-06-05 20:45:08,466 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/las-dalias-live-music
2025-06-05 20:45:10,988 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:45:15,999 - __main__ - INFO - Scroll attempt 1: height 5521
2025-06-05 20:45:18,005 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:45:18,005 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:45:18,125 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/las-dalias-live-music
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Miguel Campello (Elbicho)
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Hilight Tribe
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Raule
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Chambao
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Ky-Mani Marley &amp; General Levy
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Macaco
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Bersuit Vergarabat
2025-06-05 20:45:18,248 - __main__ - INFO - Added JSON-LD event: Alex Serra
2025-06-05 20:45:18,554 - __main__ - INFO - Found 8 events on promoter page las-dalias-live-music
2025-06-05 20:45:18,554 - __main__ - ERROR - Error saving event 'Miguel Campello (Elbicho)': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,555 - __main__ - ERROR - Error saving event 'Hilight Tribe': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,555 - __main__ - ERROR - Error saving event 'Raule': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,556 - __main__ - ERROR - Error saving event 'Chambao': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,556 - __main__ - ERROR - Error saving event 'Ky-Mani Marley &amp; General Levy': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,556 - __main__ - ERROR - Error saving event 'Macaco': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,557 - __main__ - ERROR - Error saving event 'Bersuit Vergarabat': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,557 - __main__ - ERROR - Error saving event 'Alex Serra': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:18,558 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:45:24,204 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/renaissance-akasha
2025-06-05 20:45:24,205 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/renaissance-akasha
2025-06-05 20:45:24,205 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/renaissance-akasha
2025-06-05 20:45:26,772 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:45:31,783 - __main__ - INFO - Scroll attempt 1: height 4734
2025-06-05 20:45:33,788 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:45:33,788 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:45:33,896 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/renaissance-akasha
2025-06-05 20:45:33,985 - __main__ - INFO - Added JSON-LD event: Renaissance
2025-06-05 20:45:34,154 - __main__ - INFO - Found 1 events on promoter page renaissance-akasha
2025-06-05 20:45:34,154 - __main__ - ERROR - Error saving event 'Renaissance': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:34,155 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:45:38,638 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/peace-n-music
2025-06-05 20:45:38,638 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/peace-n-music
2025-06-05 20:45:38,638 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/peace-n-music
2025-06-05 20:45:41,185 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:45:46,196 - __main__ - INFO - Scroll attempt 1: height 5944
2025-06-05 20:45:48,201 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:45:48,201 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:45:48,331 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/peace-n-music
2025-06-05 20:45:48,527 - __main__ - INFO - Added JSON-LD event: Peace N' Music Opening Party
2025-06-05 20:45:48,527 - __main__ - INFO - Added JSON-LD event: Peace N' Music
2025-06-05 20:45:48,527 - __main__ - INFO - Added JSON-LD event: Peace N' Music Closing Party
2025-06-05 20:45:49,135 - __main__ - INFO - Found 3 events on promoter page peace-n-music
2025-06-05 20:45:49,135 - __main__ - ERROR - Error saving event 'Peace N' Music Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:49,136 - __main__ - ERROR - Error saving event 'Peace N' Music': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:49,136 - __main__ - ERROR - Error saving event 'Peace N' Music Closing Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:45:49,137 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:45:54,604 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/ims-akasha
2025-06-05 20:45:54,605 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/ims-akasha
2025-06-05 20:45:54,605 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/ims-akasha
2025-06-05 20:45:57,141 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:46:02,150 - __main__ - INFO - Scroll attempt 1: height 5650
2025-06-05 20:46:04,155 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:46:04,155 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:46:04,237 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/ims-akasha
2025-06-05 20:46:04,303 - __main__ - INFO - Added JSON-LD event: IMS Ibiza Opening Party
2025-06-05 20:46:04,303 - __main__ - INFO - Added JSON-LD event: IMS Ibiza x BURN
2025-06-05 20:46:04,303 - __main__ - INFO - Added JSON-LD event: IMS Ibiza | 40 Years Of Jungle &amp; Drum 'n' Bass
2025-06-05 20:46:04,303 - __main__ - INFO - Added JSON-LD event: IMS Ibiza | Love Groove Night
2025-06-05 20:46:04,303 - __main__ - INFO - Added JSON-LD event: IMS Ibiza | Beat Hotel
2025-06-05 20:46:04,465 - __main__ - INFO - Found 5 events on promoter page ims-akasha
2025-06-05 20:46:04,465 - __main__ - ERROR - Error saving event 'IMS Ibiza Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:04,466 - __main__ - ERROR - Error saving event 'IMS Ibiza x BURN': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:04,466 - __main__ - ERROR - Error saving event 'IMS Ibiza | 40 Years Of Jungle &amp; Drum 'n' Bass': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:04,467 - __main__ - ERROR - Error saving event 'IMS Ibiza | Love Groove Night': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:04,467 - __main__ - ERROR - Error saving event 'IMS Ibiza | Beat Hotel': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:04,468 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:46:09,579 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/off-brand
2025-06-05 20:46:09,579 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/off-brand
2025-06-05 20:46:09,579 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/off-brand
2025-06-05 20:46:12,163 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:46:17,174 - __main__ - INFO - Scroll attempt 1: height 5160
2025-06-05 20:46:19,180 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:46:19,180 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:46:19,262 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/off-brand
2025-06-05 20:46:19,333 - __main__ - INFO - Added JSON-LD event: OFF BRAND
2025-06-05 20:46:19,400 - __main__ - INFO - Found 1 events on promoter page off-brand
2025-06-05 20:46:19,400 - __main__ - ERROR - Error saving event 'OFF BRAND': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:19,401 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:46:23,963 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/tales-unexpected-akasha
2025-06-05 20:46:23,963 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/tales-unexpected-akasha
2025-06-05 20:46:23,963 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/tales-unexpected-akasha
2025-06-05 20:46:26,505 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:46:31,514 - __main__ - INFO - Scroll attempt 1: height 5339
2025-06-05 20:46:33,519 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:46:33,520 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:46:33,611 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/tales-unexpected-akasha
2025-06-05 20:46:33,680 - __main__ - INFO - Added JSON-LD event: Tales Of The Unexpected
2025-06-05 20:46:33,746 - __main__ - INFO - Found 1 events on promoter page tales-unexpected-akasha
2025-06-05 20:46:33,746 - __main__ - ERROR - Error saving event 'Tales Of The Unexpected': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:33,747 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:46:37,103 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/akasha-summer-weekend-parties
2025-06-05 20:46:37,103 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/akasha-summer-weekend-parties
2025-06-05 20:46:37,103 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/akasha-summer-weekend-parties
2025-06-05 20:46:39,614 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:46:44,623 - __main__ - INFO - Scroll attempt 1: height 6026
2025-06-05 20:46:46,627 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:46:46,627 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:46:46,713 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/akasha-summer-weekend-parties
2025-06-05 20:46:46,795 - __main__ - INFO - Added JSON-LD event: Ordinary People
2025-06-05 20:46:46,795 - __main__ - INFO - Added JSON-LD event: Summer Party
2025-06-05 20:46:46,795 - __main__ - INFO - Added JSON-LD event: tINI &amp; the gang
2025-06-05 20:46:46,795 - __main__ - INFO - Added JSON-LD event: Mirage
2025-06-05 20:46:46,949 - __main__ - INFO - Found 4 events on promoter page akasha-summer-weekend-parties
2025-06-05 20:46:46,949 - __main__ - ERROR - Error saving event 'Ordinary People': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:46,949 - __main__ - ERROR - Error saving event 'Summer Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:46,950 - __main__ - ERROR - Error saving event 'tINI &amp; the gang': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:46,950 - __main__ - ERROR - Error saving event 'Mirage': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:46:46,950 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:46:51,949 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/hernan-cattaneo-las-dalias
2025-06-05 20:46:51,949 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/hernan-cattaneo-las-dalias
2025-06-05 20:46:51,949 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/hernan-cattaneo-las-dalias
2025-06-05 20:46:54,536 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:46:59,547 - __main__ - INFO - Scroll attempt 1: height 5366
2025-06-05 20:47:01,552 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:47:01,552 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:47:01,640 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/hernan-cattaneo-las-dalias
2025-06-05 20:47:01,719 - __main__ - INFO - Added JSON-LD event: Hernn Cattneo
2025-06-05 20:47:01,788 - __main__ - INFO - Found 1 events on promoter page hernan-cattaneo-las-dalias
2025-06-05 20:47:01,788 - __main__ - ERROR - Error saving event 'Hernn Cattneo': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:01,788 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:47:05,889 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/akasha-springtime-parties
2025-06-05 20:47:05,889 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/akasha-springtime-parties
2025-06-05 20:47:05,889 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/akasha-springtime-parties
2025-06-05 20:47:08,423 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:47:13,432 - __main__ - INFO - Scroll attempt 1: height 5236
2025-06-05 20:47:15,437 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:47:15,437 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:47:15,524 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/akasha-springtime-parties
2025-06-05 20:47:15,598 - __main__ - INFO - Added JSON-LD event: The Cosmic Jungle x La Tipi
2025-06-05 20:47:15,598 - __main__ - INFO - Added JSON-LD event: OuShe
2025-06-05 20:47:15,598 - __main__ - INFO - Added JSON-LD event: Season Opening Party
2025-06-05 20:47:15,599 - __main__ - INFO - Added JSON-LD event: Los Suruba presents
2025-06-05 20:47:15,599 - __main__ - INFO - Added JSON-LD event: tINI &amp; the gang
2025-06-05 20:47:15,778 - __main__ - INFO - Found 5 events on promoter page akasha-springtime-parties
2025-06-05 20:47:15,778 - __main__ - ERROR - Error saving event 'The Cosmic Jungle x La Tipi': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:15,779 - __main__ - ERROR - Error saving event 'OuShe': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:15,779 - __main__ - ERROR - Error saving event 'Season Opening Party': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:15,780 - __main__ - ERROR - Error saving event 'Los Suruba presents': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:15,780 - __main__ - ERROR - Error saving event 'tINI &amp; the gang': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:15,781 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:47:20,710 - __main__ - INFO - Processing [2]: https://www.ibiza-spotlight.com/night/promoters/akasha-winter-parties
2025-06-05 20:47:20,711 - __main__ - INFO - Promoter page detected - scraping events from: https://www.ibiza-spotlight.com/night/promoters/akasha-winter-parties
2025-06-05 20:47:20,711 - __main__ - INFO - Fetching with enhanced Playwright scrolling: https://www.ibiza-spotlight.com/night/promoters/akasha-winter-parties
2025-06-05 20:47:23,326 - __main__ - INFO - Waiting 5 seconds for initial page load...
2025-06-05 20:47:28,336 - __main__ - INFO - Scroll attempt 1: height 5609
2025-06-05 20:47:30,341 - __main__ - INFO - No new content detected after scroll attempt 1
2025-06-05 20:47:30,341 - __main__ - INFO - Completed scrolling after 1 attempts
2025-06-05 20:47:30,453 - __main__ - INFO - Year context 2025 for https://www.ibiza-spotlight.com/night/promoters/akasha-winter-parties
2025-06-05 20:47:30,554 - __main__ - INFO - Added JSON-LD event: Akasha Winter Opening
2025-06-05 20:47:30,554 - __main__ - INFO - Added JSON-LD event: Akasha
2025-06-05 20:47:30,554 - __main__ - INFO - Added JSON-LD event: Akasha | Yulia Niko presents AXEPT
2025-06-05 20:47:30,554 - __main__ - INFO - Added JSON-LD event: Akasha | SlapFunk
2025-06-05 20:47:30,554 - __main__ - INFO - Added JSON-LD event: Suruba presents
2025-06-05 20:47:30,554 - __main__ - INFO - Added JSON-LD event: OuShe
2025-06-05 20:47:30,822 - __main__ - INFO - Found 6 events on promoter page akasha-winter-parties
2025-06-05 20:47:30,823 - __main__ - ERROR - Error saving event 'Akasha Winter Opening': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:30,823 - __main__ - ERROR - Error saving event 'Akasha': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:30,823 - __main__ - ERROR - Error saving event 'Akasha | Yulia Niko presents AXEPT': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:30,824 - __main__ - ERROR - Error saving event 'Akasha | SlapFunk': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:30,824 - __main__ - ERROR - Error saving event 'Suruba presents': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:30,825 - __main__ - ERROR - Error saving event 'OuShe': 'str' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1222, in save_event
    quality_data = self.scorer.calculate_event_quality(event)
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 46, in calculate_event_quality
    scores["location"], validation_details["location"] = self._score_location(
                                                         ~~~~~~~~~~~~~~~~~~~~^
        event_data.get("location", {})
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/database/quality_scorer.py", line 130, in _score_location
    if location.get("venue"):
       ^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'
2025-06-05 20:47:30,825 - __main__ - ERROR - Error CSV append: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/home/creekz/Projects/classy_skrrrapey_mvp/classy_skkkrapey/my_scrapers/scraper_ibizaspotlight_revised_0506_final.py", line 1259, in append_to_csv
    json.dumps(v) if isinstance(v, (list, dict)) else v)
    ~~~~~~~~~~^^^
  File "/home/creekz/miniconda/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/home/creekz/miniconda/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
2025-06-05 20:47:36,811 - __main__ - INFO - ================================================================================
2025-06-05 20:47:36,812 - __main__ - INFO - SCRAPING COMPLETE - SUMMARY STATISTICS (Integrated Logic)
2025-06-05 20:47:36,812 - __main__ - INFO - ================================================================================
2025-06-05 20:47:36,812 - __main__ - INFO - Total initial URLs (venues/clubs/promoters from main page): 132
2025-06-05 20:47:36,812 - __main__ - INFO - Total promoter pages processed: 131
2025-06-05 20:47:36,812 - __main__ - INFO - Total events scraped: 354
2025-06-05 20:47:36,812 - __main__ - INFO - Total unique URLs visited: 183
2025-06-05 20:47:36,812 - __main__ - INFO - CSV file: classy_skkkrapey/scrape_logs/scraped_events_20250605_200930.csv
2025-06-05 20:47:36,812 - __main__ - INFO - Average data quality score: 93.5%
2025-06-05 20:47:36,812 - __main__ - INFO - Quality distribution:
2025-06-05 20:47:36,812 - __main__ - INFO -   - High quality (>80%): 354
2025-06-05 20:47:36,812 - __main__ - INFO -   - Medium quality (50-80%): 0
2025-06-05 20:47:36,812 - __main__ - INFO -   - Low quality (<50%): 0
2025-06-05 20:47:36,812 - __main__ - INFO - ================================================================================
2025-06-05 20:47:36,812 - __main__ - INFO - Enhanced run 20250605_200930 completed using integrated navigation logic.
2025-06-05 20:47:36,812 - __main__ - INFO - Scraping completed. Total events: 354
2025-06-05 20:47:36,813 - __main__ - INFO - Scraper shutdown for run_id: 20250605_200930.
